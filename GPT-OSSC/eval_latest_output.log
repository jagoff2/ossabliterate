[stderr] MXFP4 quantization requires triton >= 3.4.0 and kernels installed, we will default to dequantizing the model to bf16
[stderr] 
[stderr] Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]
[stderr] Loading checkpoint shards:  33%|###3      | 1/3 [00:05<00:11,  5.71s/it]
[stderr] Loading checkpoint shards:  67%|######6   | 2/3 [00:12<00:06,  6.33s/it]
[stderr] Loading checkpoint shards: 100%|##########| 3/3 [00:15<00:00,  4.69s/it]
[stderr] Loading checkpoint shards: 100%|##########| 3/3 [00:15<00:00,  5.07s/it]
[stderr] 2025-10-29 12:02:18,368 | INFO | gpt_oss_ws | GPT-OSS workspace model initialized
[stderr] +--------------------- Traceback (most recent call last) ---------------------+
[stderr] | G:\OSSC\cli\main.py:53 in eval                                              |
[stderr] |                                                                             |
[stderr] |   50   cfg = load_config(str(cfg_path))                                     |
[stderr] |   51   from evals import report                                             |
[stderr] |   52                                                                        |
[stderr] | > 53   asyncio.run(report.run(task, cfg))                                   |
[stderr] |   54                                                                        |
[stderr] |   55                                                                        |
[stderr] |   56 @app.command(name="fluency-guard")                                     |
[stderr] |                                                                             |
[stderr] | +------------------------------- locals -------------------------------+    |
[stderr] | |      cfg = WorkspaceConfig(                                          |    |
[stderr] | |                model_name='openai/gpt-oss-20b',                      |    |
[stderr] | |                quantization='Mxfp4',                                 |    |
[stderr] | |                device_map='auto',                                    |    |
[stderr] | |                hooked_layers=[1, 5, 9, 13, 17, 21],                  |    |
[stderr] | |                nvirt=4,                                              |    |
[stderr] | |                residual_rank=8,                                      |    |
[stderr] | |                slot_count=6,                                         |    |
[stderr] | |                slot_dim=256,                                         |    |
[stderr] | |                slot_iterations=1,                                    |    |
[stderr] | |                enable_kv_append=True,                                |    |
[stderr] | |                enable_residual_delta=True,                           |    |
[stderr] | |                enable_read_probes=True,                              |    |
[stderr] | |                enable_broadcast=True,                                |    |
[stderr] | |                workspace_device='cpu',                               |    |
[stderr] | |                retention=RetentionConfig(                            |    |
[stderr] | |                    virt_kv_max_tokens_per_layer=1024,                |    |
[stderr] | |                    virt_kv_ttl_steps=2048,                           |    |
[stderr] | |                    spill_to_cpu=True,                                |    |
[stderr] | |                    prefetch_margin=16                                |    |
[stderr] | |                ),                                                    |    |
[stderr] | |                log_level='INFO',                                     |    |
[stderr] | |                api_host='0.0.0.0',                                   |    |
[stderr] | |                api_port=8000,                                        |    |
[stderr] | |                controller_entropy_floor=2.5,                         |    |
[stderr] | |                controller_norm_cap=4.5,                              |    |
[stderr] | |                sqlite_path='workspace_memory.sqlite',                |    |
[stderr] | |                faiss_index_path='workspace_memory.faiss',            |    |
[stderr] | |                memory_embedding_dim=384,                             |    |
[stderr] | |                max_context_tokens=8192,                              |    |
[stderr] | |                bf16_fallback=True                                    |    |
[stderr] | |            )                                                         |    |
[stderr] | | cfg_path = WindowsPath('configs/server.yaml')                        |    |
[stderr] | |   config = None                                                      |    |
[stderr] | |   report = <module 'evals.report' from 'G:\\OSSC\\evals\\report.py'> |    |
[stderr] | |     task = 'fluency'                                                 |    |
[stderr] | +----------------------------------------------------------------------+    |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.p |
[stderr] | y:195 in run                                                                |
[stderr] |                                                                             |
[stderr] |   192             "asyncio.run() cannot be called from a running event loop |
[stderr] |   193                                                                       |
[stderr] |   194     with Runner(debug=debug, loop_factory=loop_factory) as runner:    |
[stderr] | > 195         return runner.run(main)                                       |
[stderr] |   196                                                                       |
[stderr] |   197                                                                       |
[stderr] |   198 def _cancel_all_tasks(loop):                                          |
[stderr] |                                                                             |
[stderr] | +------------------------------- locals -------------------------------+    |
[stderr] | |        debug = None                                                  |    |
[stderr] | | loop_factory = None                                                  |    |
[stderr] | |         main = <coroutine object run at 0x000002623B0E7480>          |    |
[stderr] | |       runner = <asyncio.runners.Runner object at 0x0000026333440830> |    |
[stderr] | +----------------------------------------------------------------------+    |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.p |
[stderr] | y:118 in run                                                                |
[stderr] |                                                                             |
[stderr] |   115                                                                       |
[stderr] |   116         self._interrupt_count = 0                                     |
[stderr] |   117         try:                                                          |
[stderr] | > 118             return self._loop.run_until_complete(task)                |
[stderr] |   119         except exceptions.CancelledError:                             |
[stderr] |   120             if self._interrupt_count > 0:                             |
[stderr] |   121                 uncancel = getattr(task, "uncancel", None)            |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |        context = <_contextvars.Context object at 0x0000026331436BC0>    | |
[stderr] | |           coro = <coroutine object run at 0x000002623B0E7480>           | |
[stderr] | |           self = <asyncio.runners.Runner object at 0x0000026333440830>  | |
[stderr] | | sigint_handler = functools.partial(<bound method Runner._on_sigint of   | |
[stderr] | |                  <asyncio.runners.Runner object at                      | |
[stderr] | |                  0x0000026333440830>>, main_task=<Task finished         | |
[stderr] | |                  name='Task-1' coro=<run() done, defined at             | |
[stderr] | |                  G:\OSSC\evals\report.py:17>                            | |
[stderr] | |                  exception=RuntimeError('expected m1 and m2 to have the | |
[stderr] | |                  same dtype, but got: float != struct c10::BFloat16')>) | |
[stderr] | |           task = <Task finished name='Task-1' coro=<run() done, defined | |
[stderr] | |                  at G:\OSSC\evals\report.py:17>                         | |
[stderr] | |                  exception=RuntimeError('expected m1 and m2 to have the | |
[stderr] | |                  same dtype, but got: float != struct c10::BFloat16')>  | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_even |
[stderr] | ts.py:725 in run_until_complete                                             |
[stderr] |                                                                             |
[stderr] |    722         if not future.done():                                        |
[stderr] |    723             raise RuntimeError('Event loop stopped before Future com |
[stderr] |    724                                                                      |
[stderr] | >  725         return future.result()                                       |
[stderr] |    726                                                                      |
[stderr] |    727     def stop(self):                                                  |
[stderr] |    728         """Stop running the event loop.                              |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   future = <Task finished name='Task-1' coro=<run() done, defined at    | |
[stderr] | |            G:\OSSC\evals\report.py:17> exception=RuntimeError('expected | |
[stderr] | |            m1 and m2 to have the same dtype, but got: float != struct   | |
[stderr] | |            c10::BFloat16')>                                             | |
[stderr] | | new_task = False                                                        | |
[stderr] | |     self = <ProactorEventLoop running=False closed=True debug=False>    | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | G:\OSSC\evals\report.py:27 in run                                           |
[stderr] |                                                                             |
[stderr] |   24   request_ctx = GenerationRequestContext(request_id=str(time.time()),  |
[stderr] |   25   for prompt in prompts:                                               |
[stderr] |   26     input_ids = model.tokenizer_encode(prompt)                         |
[stderr] | > 27     outputs = model.generate(request_ctx, input_ids=input_ids, max_new |
[stderr] |   28     text = model.tokenizer_decode(outputs[0])                          |
[stderr] |   29     print(json.dumps({"prompt": prompt, "completion": text}))          |
[stderr] |   30   model.close()                                                        |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |      config = WorkspaceConfig(                                          | |
[stderr] | |                   model_name='openai/gpt-oss-20b',                      | |
[stderr] | |                   quantization='Mxfp4',                                 | |
[stderr] | |                   device_map='auto',                                    | |
[stderr] | |                   hooked_layers=[1, 5, 9, 13, 17, 21],                  | |
[stderr] | |                   nvirt=4,                                              | |
[stderr] | |                   residual_rank=8,                                      | |
[stderr] | |                   slot_count=6,                                         | |
[stderr] | |                   slot_dim=256,                                         | |
[stderr] | |                   slot_iterations=1,                                    | |
[stderr] | |                   enable_kv_append=True,                                | |
[stderr] | |                   enable_residual_delta=True,                           | |
[stderr] | |                   enable_read_probes=True,                              | |
[stderr] | |                   enable_broadcast=True,                                | |
[stderr] | |                   workspace_device='cpu',                               | |
[stderr] | |                   retention=RetentionConfig(                            | |
[stderr] | |                       virt_kv_max_tokens_per_layer=1024,                | |
[stderr] | |                       virt_kv_ttl_steps=2048,                           | |
[stderr] | |                       spill_to_cpu=True,                                | |
[stderr] | |                       prefetch_margin=16                                | |
[stderr] | |                   ),                                                    | |
[stderr] | |                   log_level='INFO',                                     | |
[stderr] | |                   api_host='0.0.0.0',                                   | |
[stderr] | |                   api_port=8000,                                        | |
[stderr] | |                   controller_entropy_floor=2.5,                         | |
[stderr] | |                   controller_norm_cap=4.5,                              | |
[stderr] | |                   sqlite_path='workspace_memory.sqlite',                | |
[stderr] | |                   faiss_index_path='workspace_memory.faiss',            | |
[stderr] | |                   memory_embedding_dim=384,                             | |
[stderr] | |                   max_context_tokens=8192,                              | |
[stderr] | |                   bf16_fallback=True                                    | |
[stderr] | |               )                                                         | |
[stderr] | |   input_ids = tensor([[64614,   277,   750,   290, 43952, 49803,  2608, | |
[stderr] | |               1072,   220,    23,                                       | |
[stderr] | |                        18304,    13]])                                  | |
[stderr] | |       model = <gpt_oss_ws.model_wrapper.GPTOSSHookedModel object at     | |
[stderr] | |               0x00000263334406E0>                                       | |
[stderr] | |      prompt = 'Summarize the persistent workspace state over 8 turns.'  | |
[stderr] | |     prompts = [                                                         | |
[stderr] | |                   'Summarize the persistent workspace state over 8      | |
[stderr] | |               turns.',                                                  | |
[stderr] | |                   'Describe retention policy effects on current virtual | |
[stderr] | |               KV.'                                                      | |
[stderr] | |               ]                                                         | |
[stderr] | | request_ctx = GenerationRequestContext(                                 | |
[stderr] | |                   request_id='1761753738.370233',                       | |
[stderr] | |                   toggles=HookToggles(                                  | |
[stderr] | |                       kv_append=True,                                   | |
[stderr] | |                       residual_delta=True,                              | |
[stderr] | |                       read_probes=True,                                 | |
[stderr] | |                       broadcast=True                                    | |
[stderr] | |                   ),                                                    | |
[stderr] | |                   retention_overrides=None                              | |
[stderr] | |               )                                                         | |
[stderr] | |        task = 'fluency'                                                 | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | G:\OSSC\gpt_oss_ws\model_wrapper.py:144 in generate                         |
[stderr] |                                                                             |
[stderr] |   141   def generate(self, request: GenerationRequestContext, **kwargs) ->  |
[stderr] |   142     from .generation import generate_with_workspace                   |
[stderr] |   143                                                                       |
[stderr] | > 144     return generate_with_workspace(self, request, **kwargs)           |
[stderr] |   145                                                                       |
[stderr] |   146   def tokenizer_encode(self, text: str, **kwargs) -> torch.Tensor:    |
[stderr] |   147     return self.tokenizer(text, return_tensors="pt", **kwargs)["input |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |  kwargs = {                                                             | |
[stderr] | |               'input_ids': tensor([[64614,   277,   750,   290, 43952,  | |
[stderr] | |           49803,  2608,  1072,   220,    23,                            | |
[stderr] | |                    18304,    13]]),                                     | |
[stderr] | |               'max_new_tokens': 128                                     | |
[stderr] | |           }                                                             | |
[stderr] | | request = GenerationRequestContext(                                     | |
[stderr] | |               request_id='1761753738.370233',                           | |
[stderr] | |               toggles=HookToggles(                                      | |
[stderr] | |                   kv_append=True,                                       | |
[stderr] | |                   residual_delta=True,                                  | |
[stderr] | |                   read_probes=True,                                     | |
[stderr] | |                   broadcast=True                                        | |
[stderr] | |               ),                                                        | |
[stderr] | |               retention_overrides=None                                  | |
[stderr] | |           )                                                             | |
[stderr] | |    self = <gpt_oss_ws.model_wrapper.GPTOSSHookedModel object at         | |
[stderr] | |           0x00000263334406E0>                                           | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | G:\OSSC\gpt_oss_ws\generation.py:63 in generate_with_workspace              |
[stderr] |                                                                             |
[stderr] |   60     if cache is not None and isinstance(cache, tuple):                 |
[stderr] |   61       cache = DynamicCache.from_legacy_cache(cache)                    |
[stderr] |   62     with model.runtime_context(request.toggles):                       |
[stderr] | > 63       outputs = model.model(                                           |
[stderr] |   64         input_ids=step_input,                                          |
[stderr] |   65         attention_mask=attention_mask,                                 |
[stderr] |   66         past_key_values=cache,                                         |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |        attention_mask = tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,    | |
[stderr] | |                         1]])                                            | |
[stderr] | |                 cache = DynamicCache(layers=[DynamicSlidingWindowLayer, | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer])                                  | |
[stderr] | |        cache_position = tensor([12])                                    | |
[stderr] | |              decision = ControllerOutput(                               | |
[stderr] | |                             broadcast=True,                             | |
[stderr] | |                             retrieve=False,                             | |
[stderr] | |                             write_memory=False,                         | |
[stderr] | |                             halt=False                                  | |
[stderr] | |                         )                                               | |
[stderr] | |                device = device(type='cpu')                              | |
[stderr] | |          eos_token_id = 200002                                          | |
[stderr] | |            full_input = tensor([[64614,   277,   750,   290, 43952,     | |
[stderr] | |                         49803,  2608,  1072,   220,    23,              | |
[stderr] | |                                  18304,    13,  4066]])                 | |
[stderr] | |      generated_tokens = [tensor([4066])]                                | |
[stderr] | |             input_ids = tensor([[64614,   277,   750,   290, 43952,     | |
[stderr] | |                         49803,  2608,  1072,   220,    23,              | |
[stderr] | |                                  18304,    13]])                        | |
[stderr] | |                logits = tensor([[ 2.1094,  4.4375,  1.5547,  ...,       | |
[stderr] | |                         -0.0679, -0.0757,  0.0767]],                    | |
[stderr] | |                                dtype=torch.bfloat16,                    | |
[stderr] | |                         grad_fn=<SliceBackward0>)                       | |
[stderr] | |        max_new_tokens = 128                                             | |
[stderr] | |                 model = <gpt_oss_ws.model_wrapper.GPTOSSHookedModel     | |
[stderr] | |                         object at 0x00000263334406E0>                   | |
[stderr] | |             new_cache = DynamicCache(layers=[DynamicSlidingWindowLayer, | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer])                                  | |
[stderr] | |            next_token = tensor([4066])                                  | |
[stderr] | | next_token_unsqueezed = tensor([[4066]])                                | |
[stderr] | |               outputs = MoeCausalLMOutputWithPast(                      | |
[stderr] | |                             loss=None,                                  | |
[stderr] | |                             aux_loss=None,                              | |
[stderr] | |                             logits=tensor([[[ 5.2188,  8.1875,  6.7500, | |
[stderr] | |                         ..., -0.0579, -0.0835,  0.0972],                | |
[stderr] | |                                  [ 5.4688,  7.5000,  4.4375,  ...,      | |
[stderr] | |                         0.0281, -0.0189,  0.0410],                      | |
[stderr] | |                                  [ 3.9375,  8.5000,  3.3594,  ...,      | |
[stderr] | |                         0.0535, -0.0942,  0.1138],                      | |
[stderr] | |                                  ...,                                   | |
[stderr] | |                                  [ 5.0938,  6.4688,  3.7188,  ...,      | |
[stderr] | |                         -0.0223,  0.0315, -0.0229],                     | |
[stderr] | |                                  [ 7.3125, 11.2500,  4.0938,  ...,      | |
[stderr] | |                         -0.1221, -0.1060,  0.0986],                     | |
[stderr] | |                                  [ 2.1094,  4.4375,  1.5547,  ...,      | |
[stderr] | |                         -0.0679, -0.0757,  0.0767]]],                   | |
[stderr] | |                                dtype=torch.bfloat16,                    | |
[stderr] | |                         grad_fn=<UnsafeViewBackward0>),                 | |
[stderr] | |                             past_key_values=DynamicCache(layers=[Dynam… | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer]),                                 | |
[stderr] | |                             hidden_states=None,                         | |
[stderr] | |                             attentions=None,                            | |
[stderr] | |                             router_logits=None                          | |
[stderr] | |                         )                                               | |
[stderr] | |        position_start = 12                                              | |
[stderr] | |               request = GenerationRequestContext(                       | |
[stderr] | |                             request_id='1761753738.370233',             | |
[stderr] | |                             toggles=HookToggles(                        | |
[stderr] | |                                 kv_append=True,                         | |
[stderr] | |                                 residual_delta=True,                    | |
[stderr] | |                                 read_probes=True,                       | |
[stderr] | |                                 broadcast=True                          | |
[stderr] | |                             ),                                          | |
[stderr] | |                             retention_overrides=None                    | |
[stderr] | |                         )                                               | |
[stderr] | |                  step = 1                                               | |
[stderr] | |            step_input = tensor([[4066]])                                | |
[stderr] | |           step_length = 1                                               | |
[stderr] | |       stream_callback = None                                            | |
[stderr] | |           temperature = 0.8                                             | |
[stderr] | |                 top_p = 0.95                                            | |
[stderr] | |          total_length = 13                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1773 in _wrapped_call_impl                          |
[stderr] |                                                                             |
[stderr] |   1770         if self._compiled_call_impl is not None:                     |
[stderr] |   1771             return self._compiled_call_impl(*args, **kwargs)  # type |
[stderr] |   1772         else:                                                        |
[stderr] | > 1773             return self._call_impl(*args, **kwargs)                  |
[stderr] |   1774                                                                      |
[stderr] |   1775     # torchrec tests the code consistency with the following code    |
[stderr] |   1776     # fmt: off                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = ()                                                             | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'input_ids': tensor([[4066]]),                             | |
[stderr] | |              'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   | |
[stderr] | |          1, 1, 1]]),                                                    | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'cache_position': tensor([12]),                            | |
[stderr] | |              'use_cache': True                                          | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssForCausalLM(                                             | |
[stderr] | |            (model): GptOssModel(                                        | |
[stderr] | |              (embed_tokens): Embedding(201088, 2880,                    | |
[stderr] | |          padding_idx=199999)                                            | |
[stderr] | |              (layers): ModuleList(                                      | |
[stderr] | |                (0-23): 24 x GptOssDecoderLayer(                         | |
[stderr] | |                  (self_attn): GptOssAttention(                          | |
[stderr] | |                    (q_proj): Linear(in_features=2880,                   | |
[stderr] | |          out_features=4096, bias=True)                                  | |
[stderr] | |                    (k_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                    (v_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                    (o_proj): Linear(in_features=4096,                   | |
[stderr] | |          out_features=2880, bias=True)                                  | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (mlp): GptOssMLP(                                      | |
[stderr] | |                    (router): GptOssTopKRouter()                         | |
[stderr] | |                    (experts): GptOssExperts()                           | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)   | |
[stderr] | |                  (post_attention_layernorm): GptOssRMSNorm((2880,),     | |
[stderr] | |          eps=1e-05)                                                     | |
[stderr] | |                )                                                        | |
[stderr] | |              )                                                          | |
[stderr] | |              (norm): GptOssRMSNorm((2880,), eps=1e-05)                  | |
[stderr] | |              (rotary_emb): GptOssRotaryEmbedding()                      | |
[stderr] | |            )                                                            | |
[stderr] | |            (lm_head): Linear(in_features=2880, out_features=201088,     | |
[stderr] | |          bias=False)                                                    | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1784 in _call_impl                                  |
[stderr] |                                                                             |
[stderr] |   1781         if not (self._backward_hooks or self._backward_pre_hooks or  |
[stderr] |   1782                 or _global_backward_pre_hooks or _global_backward_ho |
[stderr] |   1783                 or _global_forward_hooks or _global_forward_pre_hook |
[stderr] | > 1784             return forward_call(*args, **kwargs)                     |
[stderr] |   1785                                                                      |
[stderr] |   1786         result = None                                                |
[stderr] |   1787         called_always_called_hooks = set()                           |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |         args = ()                                                       | |
[stderr] | | forward_call = <bound method GptOssForCausalLM.forward of               | |
[stderr] | |                GptOssForCausalLM(                                       | |
[stderr] | |                  (model): GptOssModel(                                  | |
[stderr] | |                    (embed_tokens): Embedding(201088, 2880,              | |
[stderr] | |                padding_idx=199999)                                      | |
[stderr] | |                    (layers): ModuleList(                                | |
[stderr] | |                      (0-23): 24 x GptOssDecoderLayer(                   | |
[stderr] | |                        (self_attn): GptOssAttention(                    | |
[stderr] | |                          (q_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                          (k_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                          (v_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                          (o_proj): Linear(in_features=4096,             | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                        )                                                | |
[stderr] | |                        (mlp): GptOssMLP(                                | |
[stderr] | |                          (router): GptOssTopKRouter()                   | |
[stderr] | |                          (experts): GptOssExperts()                     | |
[stderr] | |                        )                                                | |
[stderr] | |                        (input_layernorm): GptOssRMSNorm((2880,),        | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                        (post_attention_layernorm):                      | |
[stderr] | |                GptOssRMSNorm((2880,), eps=1e-05)                        | |
[stderr] | |                      )                                                  | |
[stderr] | |                    )                                                    | |
[stderr] | |                    (norm): GptOssRMSNorm((2880,), eps=1e-05)            | |
[stderr] | |                    (rotary_emb): GptOssRotaryEmbedding()                | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (lm_head): Linear(in_features=2880,                    | |
[stderr] | |                out_features=201088, bias=False)                         | |
[stderr] | |                )>                                                       | |
[stderr] | |       kwargs = {                                                        | |
[stderr] | |                    'input_ids': tensor([[4066]]),                       | |
[stderr] | |                    'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1,   | |
[stderr] | |                1, 1, 1, 1, 1]]),                                        | |
[stderr] | |                    'past_key_values':                                   | |
[stderr] | |                DynamicCache(layers=[DynamicSlidingWindowLayer,          | |
[stderr] | |                DynamicLayer, DynamicSlidingWindowLayer, DynamicLayer,   | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer]),               | |
[stderr] | |                    'cache_position': tensor([12]),                      | |
[stderr] | |                    'use_cache': True                                    | |
[stderr] | |                }                                                        | |
[stderr] | |         self = GptOssForCausalLM(                                       | |
[stderr] | |                  (model): GptOssModel(                                  | |
[stderr] | |                    (embed_tokens): Embedding(201088, 2880,              | |
[stderr] | |                padding_idx=199999)                                      | |
[stderr] | |                    (layers): ModuleList(                                | |
[stderr] | |                      (0-23): 24 x GptOssDecoderLayer(                   | |
[stderr] | |                        (self_attn): GptOssAttention(                    | |
[stderr] | |                          (q_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                          (k_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                          (v_proj): Linear(in_features=2880,             | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                          (o_proj): Linear(in_features=4096,             | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                        )                                                | |
[stderr] | |                        (mlp): GptOssMLP(                                | |
[stderr] | |                          (router): GptOssTopKRouter()                   | |
[stderr] | |                          (experts): GptOssExperts()                     | |
[stderr] | |                        )                                                | |
[stderr] | |                        (input_layernorm): GptOssRMSNorm((2880,),        | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                        (post_attention_layernorm):                      | |
[stderr] | |                GptOssRMSNorm((2880,), eps=1e-05)                        | |
[stderr] | |                      )                                                  | |
[stderr] | |                    )                                                    | |
[stderr] | |                    (norm): GptOssRMSNorm((2880,), eps=1e-05)            | |
[stderr] | |                    (rotary_emb): GptOssRotaryEmbedding()                | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (lm_head): Linear(in_features=2880,                    | |
[stderr] | |                out_features=201088, bias=False)                         | |
[stderr] | |                )                                                        | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\utils\generic.py:940 in wrapper                                   |
[stderr] |                                                                             |
[stderr] |    937         return_dict_passed = kwargs.pop("return_dict", return_dict)  |
[stderr] |    938         if return_dict_passed is not None:                           |
[stderr] |    939             return_dict = return_dict_passed                         |
[stderr] | >  940         output = func(self, *args, **kwargs)                         |
[stderr] |    941         if not return_dict and not isinstance(output, tuple):        |
[stderr] |    942             output = output.to_tuple()                               |
[stderr] |    943         return output                                                |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |               args = ()                                                 | |
[stderr] | |             kwargs = {                                                  | |
[stderr] | |                          'input_ids': tensor([[4066]]),                 | |
[stderr] | |                          'attention_mask': tensor([[1, 1, 1, 1, 1, 1,   | |
[stderr] | |                      1, 1, 1, 1, 1, 1, 1]]),                            | |
[stderr] | |                          'past_key_values':                             | |
[stderr] | |                      DynamicCache(layers=[DynamicSlidingWindowLayer,    | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer, DynamicSlidingWindowLayer,           | |
[stderr] | |                      DynamicLayer]),                                    | |
[stderr] | |                          'cache_position': tensor([12]),                | |
[stderr] | |                          'use_cache': True                              | |
[stderr] | |                      }                                                  | |
[stderr] | |        return_dict = True                                               | |
[stderr] | | return_dict_passed = True                                               | |
[stderr] | |               self = GptOssForCausalLM(                                 | |
[stderr] | |                        (model): GptOssModel(                            | |
[stderr] | |                          (embed_tokens): Embedding(201088, 2880,        | |
[stderr] | |                      padding_idx=199999)                                | |
[stderr] | |                          (layers): ModuleList(                          | |
[stderr] | |                            (0-23): 24 x GptOssDecoderLayer(             | |
[stderr] | |                              (self_attn): GptOssAttention(              | |
[stderr] | |                                (q_proj): Linear(in_features=2880,       | |
[stderr] | |                      out_features=4096, bias=True)                      | |
[stderr] | |                                (k_proj): Linear(in_features=2880,       | |
[stderr] | |                      out_features=512, bias=True)                       | |
[stderr] | |                                (v_proj): Linear(in_features=2880,       | |
[stderr] | |                      out_features=512, bias=True)                       | |
[stderr] | |                                (o_proj): Linear(in_features=4096,       | |
[stderr] | |                      out_features=2880, bias=True)                      | |
[stderr] | |                              )                                          | |
[stderr] | |                              (mlp): GptOssMLP(                          | |
[stderr] | |                                (router): GptOssTopKRouter()             | |
[stderr] | |                                (experts): GptOssExperts()               | |
[stderr] | |                              )                                          | |
[stderr] | |                              (input_layernorm): GptOssRMSNorm((2880,),  | |
[stderr] | |                      eps=1e-05)                                         | |
[stderr] | |                              (post_attention_layernorm):                | |
[stderr] | |                      GptOssRMSNorm((2880,), eps=1e-05)                  | |
[stderr] | |                            )                                            | |
[stderr] | |                          )                                              | |
[stderr] | |                          (norm): GptOssRMSNorm((2880,), eps=1e-05)      | |
[stderr] | |                          (rotary_emb): GptOssRotaryEmbedding()          | |
[stderr] | |                        )                                                | |
[stderr] | |                        (lm_head): Linear(in_features=2880,              | |
[stderr] | |                      out_features=201088, bias=False)                   | |
[stderr] | |                      )                                                  | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\models\gpt_oss\modeling_gpt_oss.py:663 in forward                 |
[stderr] |                                                                             |
[stderr] |   660         )                                                             |
[stderr] |   661                                                                       |
[stderr] |   662         # decoder outputs consists of (dec_features, layer_state, dec |
[stderr] | > 663         outputs: MoeModelOutputWithPast = self.model(                 |
[stderr] |   664             input_ids=input_ids,                                      |
[stderr] |   665             attention_mask=attention_mask,                            |
[stderr] |   666             position_ids=position_ids,                                |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |       attention_mask = tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,     | |
[stderr] | |                        1]])                                             | |
[stderr] | |       cache_position = tensor([12])                                     | |
[stderr] | |            input_ids = tensor([[4066]])                                 | |
[stderr] | |        inputs_embeds = None                                             | |
[stderr] | |               kwargs = {}                                               | |
[stderr] | |               labels = None                                             | |
[stderr] | |       logits_to_keep = 0                                                | |
[stderr] | | output_router_logits = False                                            | |
[stderr] | |      past_key_values = DynamicCache(layers=[DynamicSlidingWindowLayer,  | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer, DynamicSlidingWindowLayer,         | |
[stderr] | |                        DynamicLayer])                                   | |
[stderr] | |         position_ids = None                                             | |
[stderr] | |                 self = GptOssForCausalLM(                               | |
[stderr] | |                          (model): GptOssModel(                          | |
[stderr] | |                            (embed_tokens): Embedding(201088, 2880,      | |
[stderr] | |                        padding_idx=199999)                              | |
[stderr] | |                            (layers): ModuleList(                        | |
[stderr] | |                              (0-23): 24 x GptOssDecoderLayer(           | |
[stderr] | |                                (self_attn): GptOssAttention(            | |
[stderr] | |                                  (q_proj): Linear(in_features=2880,     | |
[stderr] | |                        out_features=4096, bias=True)                    | |
[stderr] | |                                  (k_proj): Linear(in_features=2880,     | |
[stderr] | |                        out_features=512, bias=True)                     | |
[stderr] | |                                  (v_proj): Linear(in_features=2880,     | |
[stderr] | |                        out_features=512, bias=True)                     | |
[stderr] | |                                  (o_proj): Linear(in_features=4096,     | |
[stderr] | |                        out_features=2880, bias=True)                    | |
[stderr] | |                                )                                        | |
[stderr] | |                                (mlp): GptOssMLP(                        | |
[stderr] | |                                  (router): GptOssTopKRouter()           | |
[stderr] | |                                  (experts): GptOssExperts()             | |
[stderr] | |                                )                                        | |
[stderr] | |                                (input_layernorm):                       | |
[stderr] | |                        GptOssRMSNorm((2880,), eps=1e-05)                | |
[stderr] | |                                (post_attention_layernorm):              | |
[stderr] | |                        GptOssRMSNorm((2880,), eps=1e-05)                | |
[stderr] | |                              )                                          | |
[stderr] | |                            )                                            | |
[stderr] | |                            (norm): GptOssRMSNorm((2880,), eps=1e-05)    | |
[stderr] | |                            (rotary_emb): GptOssRotaryEmbedding()        | |
[stderr] | |                          )                                              | |
[stderr] | |                          (lm_head): Linear(in_features=2880,            | |
[stderr] | |                        out_features=201088, bias=False)                 | |
[stderr] | |                        )                                                | |
[stderr] | |            use_cache = True                                             | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1773 in _wrapped_call_impl                          |
[stderr] |                                                                             |
[stderr] |   1770         if self._compiled_call_impl is not None:                     |
[stderr] |   1771             return self._compiled_call_impl(*args, **kwargs)  # type |
[stderr] |   1772         else:                                                        |
[stderr] | > 1773             return self._call_impl(*args, **kwargs)                  |
[stderr] |   1774                                                                      |
[stderr] |   1775     # torchrec tests the code consistency with the following code    |
[stderr] |   1776     # fmt: off                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = ()                                                             | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'input_ids': tensor([[4066]]),                             | |
[stderr] | |              'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   | |
[stderr] | |          1, 1, 1]]),                                                    | |
[stderr] | |              'position_ids': None,                                      | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'inputs_embeds': None,                                     | |
[stderr] | |              'use_cache': True,                                         | |
[stderr] | |              'output_router_logits': False,                             | |
[stderr] | |              'cache_position': tensor([12])                             | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssModel(                                                   | |
[stderr] | |            (embed_tokens): Embedding(201088, 2880, padding_idx=199999)  | |
[stderr] | |            (layers): ModuleList(                                        | |
[stderr] | |              (0-23): 24 x GptOssDecoderLayer(                           | |
[stderr] | |                (self_attn): GptOssAttention(                            | |
[stderr] | |                  (q_proj): Linear(in_features=2880, out_features=4096,  | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                  (k_proj): Linear(in_features=2880, out_features=512,   | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                  (v_proj): Linear(in_features=2880, out_features=512,   | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                  (o_proj): Linear(in_features=4096, out_features=2880,  | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |                )                                                        | |
[stderr] | |                (mlp): GptOssMLP(                                        | |
[stderr] | |                  (router): GptOssTopKRouter()                           | |
[stderr] | |                  (experts): GptOssExperts()                             | |
[stderr] | |                )                                                        | |
[stderr] | |                (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)     | |
[stderr] | |                (post_attention_layernorm): GptOssRMSNorm((2880,),       | |
[stderr] | |          eps=1e-05)                                                     | |
[stderr] | |              )                                                          | |
[stderr] | |            )                                                            | |
[stderr] | |            (norm): GptOssRMSNorm((2880,), eps=1e-05)                    | |
[stderr] | |            (rotary_emb): GptOssRotaryEmbedding()                        | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1784 in _call_impl                                  |
[stderr] |                                                                             |
[stderr] |   1781         if not (self._backward_hooks or self._backward_pre_hooks or  |
[stderr] |   1782                 or _global_backward_pre_hooks or _global_backward_ho |
[stderr] |   1783                 or _global_forward_hooks or _global_forward_pre_hook |
[stderr] | > 1784             return forward_call(*args, **kwargs)                     |
[stderr] |   1785                                                                      |
[stderr] |   1786         result = None                                                |
[stderr] |   1787         called_always_called_hooks = set()                           |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |         args = ()                                                       | |
[stderr] | | forward_call = <bound method GptOssModel.forward of GptOssModel(        | |
[stderr] | |                  (embed_tokens): Embedding(201088, 2880,                | |
[stderr] | |                padding_idx=199999)                                      | |
[stderr] | |                  (layers): ModuleList(                                  | |
[stderr] | |                    (0-23): 24 x GptOssDecoderLayer(                     | |
[stderr] | |                      (self_attn): GptOssAttention(                      | |
[stderr] | |                        (q_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                        (k_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                        (v_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                        (o_proj): Linear(in_features=4096,               | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                      )                                                  | |
[stderr] | |                      (mlp): GptOssMLP(                                  | |
[stderr] | |                        (router): GptOssTopKRouter()                     | |
[stderr] | |                        (experts): GptOssExperts()                       | |
[stderr] | |                      )                                                  | |
[stderr] | |                      (input_layernorm): GptOssRMSNorm((2880,),          | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                      (post_attention_layernorm): GptOssRMSNorm((2880,), | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                    )                                                    | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (norm): GptOssRMSNorm((2880,), eps=1e-05)              | |
[stderr] | |                  (rotary_emb): GptOssRotaryEmbedding()                  | |
[stderr] | |                )>                                                       | |
[stderr] | |       kwargs = {                                                        | |
[stderr] | |                    'input_ids': tensor([[4066]]),                       | |
[stderr] | |                    'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1,   | |
[stderr] | |                1, 1, 1, 1, 1]]),                                        | |
[stderr] | |                    'position_ids': None,                                | |
[stderr] | |                    'past_key_values':                                   | |
[stderr] | |                DynamicCache(layers=[DynamicSlidingWindowLayer,          | |
[stderr] | |                DynamicLayer, DynamicSlidingWindowLayer, DynamicLayer,   | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer]),               | |
[stderr] | |                    'inputs_embeds': None,                               | |
[stderr] | |                    'use_cache': True,                                   | |
[stderr] | |                    'output_router_logits': False,                       | |
[stderr] | |                    'cache_position': tensor([12])                       | |
[stderr] | |                }                                                        | |
[stderr] | |         self = GptOssModel(                                             | |
[stderr] | |                  (embed_tokens): Embedding(201088, 2880,                | |
[stderr] | |                padding_idx=199999)                                      | |
[stderr] | |                  (layers): ModuleList(                                  | |
[stderr] | |                    (0-23): 24 x GptOssDecoderLayer(                     | |
[stderr] | |                      (self_attn): GptOssAttention(                      | |
[stderr] | |                        (q_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                        (k_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                        (v_proj): Linear(in_features=2880,               | |
[stderr] | |                out_features=512, bias=True)                             | |
[stderr] | |                        (o_proj): Linear(in_features=4096,               | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                      )                                                  | |
[stderr] | |                      (mlp): GptOssMLP(                                  | |
[stderr] | |                        (router): GptOssTopKRouter()                     | |
[stderr] | |                        (experts): GptOssExperts()                       | |
[stderr] | |                      )                                                  | |
[stderr] | |                      (input_layernorm): GptOssRMSNorm((2880,),          | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                      (post_attention_layernorm): GptOssRMSNorm((2880,), | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                    )                                                    | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (norm): GptOssRMSNorm((2880,), eps=1e-05)              | |
[stderr] | |                  (rotary_emb): GptOssRotaryEmbedding()                  | |
[stderr] | |                )                                                        | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\utils\generic.py:1064 in wrapper                                  |
[stderr] |                                                                             |
[stderr] |   1061                         module.forward = make_capture_wrapper(module |
[stderr] |   1062                         monkey_patched_layers.append((module, origin |
[stderr] |   1063                                                                      |
[stderr] | > 1064         outputs = func(self, *args, **kwargs)                        |
[stderr] |   1065         # Restore original forward methods                           |
[stderr] |   1066         for module, original_forward in monkey_patched_layers:       |
[stderr] |   1067             module.forward = original_forward                        |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |              all_args = {                                               | |
[stderr] | |                             'input_ids': tensor([[4066]]),              | |
[stderr] | |                             'attention_mask': tensor([[1, 1, 1, 1, 1,   | |
[stderr] | |                         1, 1, 1, 1, 1, 1, 1, 1]]),                      | |
[stderr] | |                             'position_ids': None,                       | |
[stderr] | |                             'past_key_values':                          | |
[stderr] | |                         DynamicCache(layers=[DynamicSlidingWindowLayer, | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer]),                                 | |
[stderr] | |                             'inputs_embeds': None,                      | |
[stderr] | |                             'use_cache': True,                          | |
[stderr] | |                             'output_router_logits': False,              | |
[stderr] | |                             'cache_position': tensor([12])              | |
[stderr] | |                         }                                               | |
[stderr] | |                  args = ()                                              | |
[stderr] | |         capture_flags = {                                               | |
[stderr] | |                             'router_logits': OutputRecorder(            | |
[stderr] | |                                 target_class=<class                     | |
[stderr] | |                         'transformers.models.gpt_oss.modeling_gpt_oss.… | |
[stderr] | |                                 index=0,                                | |
[stderr] | |                                 layer_name=None,                        | |
[stderr] | |                                 class_name=None                         | |
[stderr] | |                             ),                                          | |
[stderr] | |                             'hidden_states': <class                     | |
[stderr] | |                         'transformers.models.gpt_oss.modeling_gpt_oss.… | |
[stderr] | |                             'attentions': <class                        | |
[stderr] | |                         'transformers.models.gpt_oss.modeling_gpt_oss.… | |
[stderr] | |                         }                                               | |
[stderr] | |     collected_outputs = defaultdict(<class 'tuple'>, {})                | |
[stderr] | |                kwargs = {                                               | |
[stderr] | |                             'input_ids': tensor([[4066]]),              | |
[stderr] | |                             'attention_mask': tensor([[1, 1, 1, 1, 1,   | |
[stderr] | |                         1, 1, 1, 1, 1, 1, 1, 1]]),                      | |
[stderr] | |                             'position_ids': None,                       | |
[stderr] | |                             'past_key_values':                          | |
[stderr] | |                         DynamicCache(layers=[DynamicSlidingWindowLayer, | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer, DynamicSlidingWindowLayer,        | |
[stderr] | |                         DynamicLayer]),                                 | |
[stderr] | |                             'inputs_embeds': None,                      | |
[stderr] | |                             'use_cache': True,                          | |
[stderr] | |                             'output_router_logits': False,              | |
[stderr] | |                             'cache_position': tensor([12])              | |
[stderr] | |                         }                                               | |
[stderr] | | monkey_patched_layers = []                                              | |
[stderr] | |       recordable_keys = {                                               | |
[stderr] | |                             'output_router_logits': False,              | |
[stderr] | |                             'output_hidden_states': False,              | |
[stderr] | |                             'output_attentions': False                  | |
[stderr] | |                         }                                               | |
[stderr] | |           return_dict = True                                            | |
[stderr] | |                  self = GptOssModel(                                    | |
[stderr] | |                           (embed_tokens): Embedding(201088, 2880,       | |
[stderr] | |                         padding_idx=199999)                             | |
[stderr] | |                           (layers): ModuleList(                         | |
[stderr] | |                             (0-23): 24 x GptOssDecoderLayer(            | |
[stderr] | |                               (self_attn): GptOssAttention(             | |
[stderr] | |                                 (q_proj): Linear(in_features=2880,      | |
[stderr] | |                         out_features=4096, bias=True)                   | |
[stderr] | |                                 (k_proj): Linear(in_features=2880,      | |
[stderr] | |                         out_features=512, bias=True)                    | |
[stderr] | |                                 (v_proj): Linear(in_features=2880,      | |
[stderr] | |                         out_features=512, bias=True)                    | |
[stderr] | |                                 (o_proj): Linear(in_features=4096,      | |
[stderr] | |                         out_features=2880, bias=True)                   | |
[stderr] | |                               )                                         | |
[stderr] | |                               (mlp): GptOssMLP(                         | |
[stderr] | |                                 (router): GptOssTopKRouter()            | |
[stderr] | |                                 (experts): GptOssExperts()              | |
[stderr] | |                               )                                         | |
[stderr] | |                               (input_layernorm): GptOssRMSNorm((2880,), | |
[stderr] | |                         eps=1e-05)                                      | |
[stderr] | |                               (post_attention_layernorm):               | |
[stderr] | |                         GptOssRMSNorm((2880,), eps=1e-05)               | |
[stderr] | |                             )                                           | |
[stderr] | |                           )                                             | |
[stderr] | |                           (norm): GptOssRMSNorm((2880,), eps=1e-05)     | |
[stderr] | |                           (rotary_emb): GptOssRotaryEmbedding()         | |
[stderr] | |                         )                                               | |
[stderr] | |             use_cache = True                                            | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\models\gpt_oss\modeling_gpt_oss.py:502 in forward                 |
[stderr] |                                                                             |
[stderr] |   499         position_embeddings = self.rotary_emb(hidden_states, position |
[stderr] |   500                                                                       |
[stderr] |   501         for decoder_layer in self.layers:                             |
[stderr] | > 502             hidden_states = decoder_layer(                            |
[stderr] |   503                 hidden_states,                                        |
[stderr] |   504                 attention_mask=causal_mask_mapping[decoder_layer.atte |
[stderr] |   505                 position_ids=position_ids,                            |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |      attention_mask = tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]) | |
[stderr] | |      cache_position = tensor([12])                                      | |
[stderr] | | causal_mask_mapping = {                                                 | |
[stderr] | |                           'full_attention': tensor([[[[0., 0., 0., 0.,  | |
[stderr] | |                       0., 0., 0., 0., 0., 0., 0., 0., 0.]]]],           | |
[stderr] | |                              dtype=torch.bfloat16),                     | |
[stderr] | |                           'sliding_attention': tensor([[[[0., 0., 0.,   | |
[stderr] | |                       0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]]],       | |
[stderr] | |                              dtype=torch.bfloat16)                      | |
[stderr] | |                       }                                                 | |
[stderr] | |       decoder_layer = GptOssDecoderLayer(                               | |
[stderr] | |                         (self_attn): GptOssAttention(                   | |
[stderr] | |                           (q_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=4096, bias=True)                     | |
[stderr] | |                           (k_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                           (v_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                           (o_proj): Linear(in_features=4096,            | |
[stderr] | |                       out_features=2880, bias=True)                     | |
[stderr] | |                         )                                               | |
[stderr] | |                         (mlp): GptOssMLP(                               | |
[stderr] | |                           (router): GptOssTopKRouter()                  | |
[stderr] | |                           (experts): GptOssExperts()                    | |
[stderr] | |                         )                                               | |
[stderr] | |                         (input_layernorm): GptOssRMSNorm((2880,),       | |
[stderr] | |                       eps=1e-05)                                        | |
[stderr] | |                         (post_attention_layernorm):                     | |
[stderr] | |                       GptOssRMSNorm((2880,), eps=1e-05)                 | |
[stderr] | |                       )                                                 | |
[stderr] | |       hidden_states = tensor([[[-0.3906, -0.0898,  0.2305,  ...,        | |
[stderr] | |                       -0.2373,  0.1309, -0.3086]]],                     | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<AddBackward0>)                           | |
[stderr] | |           input_ids = tensor([[4066]])                                  | |
[stderr] | |       inputs_embeds = tensor([[[-0.1328, -0.1338,  0.1021,  ...,        | |
[stderr] | |                       -0.0559,  0.0339,  0.1270]]],                     | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<EmbeddingBackward0>)                     | |
[stderr] | |              kwargs = {'output_router_logits': False}                   | |
[stderr] | |         mask_kwargs = {                                                 | |
[stderr] | |                           'config': GptOssConfig {                      | |
[stderr] | |                         "architectures": [                              | |
[stderr] | |                           "GptOssForCausalLM"                           | |
[stderr] | |                         ],                                              | |
[stderr] | |                         "attention_bias": true,                         | |
[stderr] | |                         "attention_dropout": 0.0,                       | |
[stderr] | |                         "dtype": "bfloat16",                            | |
[stderr] | |                         "eos_token_id": 200002,                         | |
[stderr] | |                         "experts_per_token": 4,                         | |
[stderr] | |                         "head_dim": 64,                                 | |
[stderr] | |                         "hidden_act": "silu",                           | |
[stderr] | |                         "hidden_size": 2880,                            | |
[stderr] | |                         "initial_context_length": 4096,                 | |
[stderr] | |                         "initializer_range": 0.02,                      | |
[stderr] | |                         "intermediate_size": 2880,                      | |
[stderr] | |                         "layer_types": [                                | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention",                             | |
[stderr] | |                           "sliding_attention",                          | |
[stderr] | |                           "full_attention"                              | |
[stderr] | |                         ],                                              | |
[stderr] | |                         "max_position_embeddings": 131072,              | |
[stderr] | |                         "model_type": "gpt_oss",                        | |
[stderr] | |                         "num_attention_heads": 64,                      | |
[stderr] | |                         "num_experts_per_tok": 4,                       | |
[stderr] | |                         "num_hidden_layers": 24,                        | |
[stderr] | |                         "num_key_value_heads": 8,                       | |
[stderr] | |                         "num_local_experts": 32,                        | |
[stderr] | |                         "output_router_logits": false,                  | |
[stderr] | |                         "pad_token_id": 199999,                         | |
[stderr] | |                         "rms_norm_eps": 1e-05,                          | |
[stderr] | |                         "rope_scaling": {                               | |
[stderr] | |                           "beta_fast": 32.0,                            | |
[stderr] | |                           "beta_slow": 1.0,                             | |
[stderr] | |                           "factor": 32.0,                               | |
[stderr] | |                           "original_max_position_embeddings": 4096,     | |
[stderr] | |                           "rope_type": "yarn",                          | |
[stderr] | |                           "truncate": false                             | |
[stderr] | |                         },                                              | |
[stderr] | |                         "rope_theta": 150000,                           | |
[stderr] | |                         "router_aux_loss_coef": 0.9,                    | |
[stderr] | |                         "sliding_window": 128,                          | |
[stderr] | |                         "swiglu_limit": 7.0,                            | |
[stderr] | |                         "tie_word_embeddings": false,                   | |
[stderr] | |                         "transformers_version": "4.56.2",               | |
[stderr] | |                         "use_cache": true,                              | |
[stderr] | |                         "vocab_size": 201088                            | |
[stderr] | |                       }                                                 | |
[stderr] | |                       ,                                                 | |
[stderr] | |                           'input_embeds': tensor([[[-0.1328, -0.1338,   | |
[stderr] | |                       0.1021,  ..., -0.0559,  0.0339,  0.1270]]],       | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<EmbeddingBackward0>),                    | |
[stderr] | |                           'attention_mask': tensor([[1, 1, 1, 1, 1, 1,  | |
[stderr] | |                       1, 1, 1, 1, 1, 1, 1]]),                           | |
[stderr] | |                           'cache_position': tensor([12]),               | |
[stderr] | |                           'past_key_values':                            | |
[stderr] | |                       DynamicCache(layers=[DynamicSlidingWindowLayer,   | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer])                                    | |
[stderr] | |                       }                                                 | |
[stderr] | |     past_key_values = DynamicCache(layers=[DynamicSlidingWindowLayer,   | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer])                                    | |
[stderr] | | position_embeddings = (                                                 | |
[stderr] | |                           tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, | |
[stderr] | |                       -1.2188, -0.3887,  0.3809,                        | |
[stderr] | |                                  0.8516,  1.1016,  1.2500,  1.3125,     | |
[stderr] | |                       1.3359,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438]]],  | |
[stderr] | |                       dtype=torch.bfloat16),                            | |
[stderr] | |                           tensor([[[-7.2266e-01,  1.2344e+00,           | |
[stderr] | |                       -7.4609e-01, -9.4922e-01,  5.7031e-01,            | |
[stderr] | |                                  1.2891e+00,  1.2891e+00,  1.0391e+00,  | |
[stderr] | |                       7.6953e-01,  5.0000e-01,                          | |
[stderr] | |                                  3.1055e-01,  1.8652e-01,  1.0986e-01,  | |
[stderr] | |                       6.2256e-02,  3.3936e-02,                          | |
[stderr] | |                                  1.6968e-02,  7.3853e-03,  2.0905e-03,  | |
[stderr] | |                       6.1798e-04,  4.2725e-04,                          | |
[stderr] | |                                  2.9373e-04,  2.0218e-04,  1.3924e-04,  | |
[stderr] | |                       9.6321e-05,  6.6280e-05,                          | |
[stderr] | |                                  4.5538e-05,  3.1471e-05,  2.1696e-05,  | |
[stderr] | |                       1.4961e-05,  1.0312e-05,                          | |
[stderr] | |                                  7.0930e-06,  4.8876e-06]]],            | |
[stderr] | |                       dtype=torch.bfloat16)                             | |
[stderr] | |                       )                                                 | |
[stderr] | |        position_ids = tensor([[12]])                                    | |
[stderr] | |                self = GptOssModel(                                      | |
[stderr] | |                         (embed_tokens): Embedding(201088, 2880,         | |
[stderr] | |                       padding_idx=199999)                               | |
[stderr] | |                         (layers): ModuleList(                           | |
[stderr] | |                           (0-23): 24 x GptOssDecoderLayer(              | |
[stderr] | |                             (self_attn): GptOssAttention(               | |
[stderr] | |                               (q_proj): Linear(in_features=2880,        | |
[stderr] | |                       out_features=4096, bias=True)                     | |
[stderr] | |                               (k_proj): Linear(in_features=2880,        | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                               (v_proj): Linear(in_features=2880,        | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                               (o_proj): Linear(in_features=4096,        | |
[stderr] | |                       out_features=2880, bias=True)                     | |
[stderr] | |                             )                                           | |
[stderr] | |                             (mlp): GptOssMLP(                           | |
[stderr] | |                               (router): GptOssTopKRouter()              | |
[stderr] | |                               (experts): GptOssExperts()                | |
[stderr] | |                             )                                           | |
[stderr] | |                             (input_layernorm): GptOssRMSNorm((2880,),   | |
[stderr] | |                       eps=1e-05)                                        | |
[stderr] | |                             (post_attention_layernorm):                 | |
[stderr] | |                       GptOssRMSNorm((2880,), eps=1e-05)                 | |
[stderr] | |                           )                                             | |
[stderr] | |                         )                                               | |
[stderr] | |                         (norm): GptOssRMSNorm((2880,), eps=1e-05)       | |
[stderr] | |                         (rotary_emb): GptOssRotaryEmbedding()           | |
[stderr] | |                       )                                                 | |
[stderr] | |           use_cache = True                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\modeling_layers.py:94 in __call__                                 |
[stderr] |                                                                             |
[stderr] |    91                 logger.warning_once(message)                          |
[stderr] |    92                                                                       |
[stderr] |    93             return self._gradient_checkpointing_func(partial(super(). |
[stderr] | >  94         return super().__call__(*args, **kwargs)                      |
[stderr] |    95                                                                       |
[stderr] |    96                                                                       |
[stderr] |    97 @auto_docstring                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = (                                                              | |
[stderr] | |              tensor([[[-0.3906, -0.0898,  0.2305,  ..., -0.2373,        | |
[stderr] | |          0.1309, -0.3086]]],                                            | |
[stderr] | |                 dtype=torch.bfloat16, grad_fn=<AddBackward0>),          | |
[stderr] | |          )                                                              | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'attention_mask': tensor([[[[0., 0., 0., 0., 0., 0., 0.,   | |
[stderr] | |          0., 0., 0., 0., 0., 0.]]]],                                    | |
[stderr] | |                 dtype=torch.bfloat16),                                  | |
[stderr] | |              'position_ids': tensor([[12]]),                            | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'use_cache': True,                                         | |
[stderr] | |              'cache_position': tensor([12]),                            | |
[stderr] | |              'position_embeddings': (                                   | |
[stderr] | |                  tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, -1.2188, | |
[stderr] | |          -0.3887,  0.3809,                                              | |
[stderr] | |                     0.8516,  1.1016,  1.2500,  1.3125,  1.3359,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438]]],               | |
[stderr] | |          dtype=torch.bfloat16),                                         | |
[stderr] | |                  tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01,       | |
[stderr] | |          -9.4922e-01,  5.7031e-01,                                      | |
[stderr] | |                     1.2891e+00,  1.2891e+00,  1.0391e+00,  7.6953e-01,  | |
[stderr] | |          5.0000e-01,                                                    | |
[stderr] | |                     3.1055e-01,  1.8652e-01,  1.0986e-01,  6.2256e-02,  | |
[stderr] | |          3.3936e-02,                                                    | |
[stderr] | |                     1.6968e-02,  7.3853e-03,  2.0905e-03,  6.1798e-04,  | |
[stderr] | |          4.2725e-04,                                                    | |
[stderr] | |                     2.9373e-04,  2.0218e-04,  1.3924e-04,  9.6321e-05,  | |
[stderr] | |          6.6280e-05,                                                    | |
[stderr] | |                     4.5538e-05,  3.1471e-05,  2.1696e-05,  1.4961e-05,  | |
[stderr] | |          1.0312e-05,                                                    | |
[stderr] | |                     7.0930e-06,  4.8876e-06]]], dtype=torch.bfloat16)   | |
[stderr] | |              ),                                                         | |
[stderr] | |              'output_router_logits': False                              | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssDecoderLayer(                                            | |
[stderr] | |            (self_attn): GptOssAttention(                                | |
[stderr] | |              (q_proj): Linear(in_features=2880, out_features=4096,      | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (k_proj): Linear(in_features=2880, out_features=512,       | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (v_proj): Linear(in_features=2880, out_features=512,       | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (o_proj): Linear(in_features=4096, out_features=2880,      | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            )                                                            | |
[stderr] | |            (mlp): GptOssMLP(                                            | |
[stderr] | |              (router): GptOssTopKRouter()                               | |
[stderr] | |              (experts): GptOssExperts()                                 | |
[stderr] | |            )                                                            | |
[stderr] | |            (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)         | |
[stderr] | |            (post_attention_layernorm): GptOssRMSNorm((2880,),           | |
[stderr] | |          eps=1e-05)                                                     | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1773 in _wrapped_call_impl                          |
[stderr] |                                                                             |
[stderr] |   1770         if self._compiled_call_impl is not None:                     |
[stderr] |   1771             return self._compiled_call_impl(*args, **kwargs)  # type |
[stderr] |   1772         else:                                                        |
[stderr] | > 1773             return self._call_impl(*args, **kwargs)                  |
[stderr] |   1774                                                                      |
[stderr] |   1775     # torchrec tests the code consistency with the following code    |
[stderr] |   1776     # fmt: off                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = (                                                              | |
[stderr] | |              tensor([[[-0.3906, -0.0898,  0.2305,  ..., -0.2373,        | |
[stderr] | |          0.1309, -0.3086]]],                                            | |
[stderr] | |                 dtype=torch.bfloat16, grad_fn=<AddBackward0>),          | |
[stderr] | |          )                                                              | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'attention_mask': tensor([[[[0., 0., 0., 0., 0., 0., 0.,   | |
[stderr] | |          0., 0., 0., 0., 0., 0.]]]],                                    | |
[stderr] | |                 dtype=torch.bfloat16),                                  | |
[stderr] | |              'position_ids': tensor([[12]]),                            | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'use_cache': True,                                         | |
[stderr] | |              'cache_position': tensor([12]),                            | |
[stderr] | |              'position_embeddings': (                                   | |
[stderr] | |                  tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, -1.2188, | |
[stderr] | |          -0.3887,  0.3809,                                              | |
[stderr] | |                     0.8516,  1.1016,  1.2500,  1.3125,  1.3359,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438]]],               | |
[stderr] | |          dtype=torch.bfloat16),                                         | |
[stderr] | |                  tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01,       | |
[stderr] | |          -9.4922e-01,  5.7031e-01,                                      | |
[stderr] | |                     1.2891e+00,  1.2891e+00,  1.0391e+00,  7.6953e-01,  | |
[stderr] | |          5.0000e-01,                                                    | |
[stderr] | |                     3.1055e-01,  1.8652e-01,  1.0986e-01,  6.2256e-02,  | |
[stderr] | |          3.3936e-02,                                                    | |
[stderr] | |                     1.6968e-02,  7.3853e-03,  2.0905e-03,  6.1798e-04,  | |
[stderr] | |          4.2725e-04,                                                    | |
[stderr] | |                     2.9373e-04,  2.0218e-04,  1.3924e-04,  9.6321e-05,  | |
[stderr] | |          6.6280e-05,                                                    | |
[stderr] | |                     4.5538e-05,  3.1471e-05,  2.1696e-05,  1.4961e-05,  | |
[stderr] | |          1.0312e-05,                                                    | |
[stderr] | |                     7.0930e-06,  4.8876e-06]]], dtype=torch.bfloat16)   | |
[stderr] | |              ),                                                         | |
[stderr] | |              'output_router_logits': False                              | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssDecoderLayer(                                            | |
[stderr] | |            (self_attn): GptOssAttention(                                | |
[stderr] | |              (q_proj): Linear(in_features=2880, out_features=4096,      | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (k_proj): Linear(in_features=2880, out_features=512,       | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (v_proj): Linear(in_features=2880, out_features=512,       | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |              (o_proj): Linear(in_features=4096, out_features=2880,      | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            )                                                            | |
[stderr] | |            (mlp): GptOssMLP(                                            | |
[stderr] | |              (router): GptOssTopKRouter()                               | |
[stderr] | |              (experts): GptOssExperts()                                 | |
[stderr] | |            )                                                            | |
[stderr] | |            (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)         | |
[stderr] | |            (post_attention_layernorm): GptOssRMSNorm((2880,),           | |
[stderr] | |          eps=1e-05)                                                     | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1784 in _call_impl                                  |
[stderr] |                                                                             |
[stderr] |   1781         if not (self._backward_hooks or self._backward_pre_hooks or  |
[stderr] |   1782                 or _global_backward_pre_hooks or _global_backward_ho |
[stderr] |   1783                 or _global_forward_hooks or _global_forward_pre_hook |
[stderr] | > 1784             return forward_call(*args, **kwargs)                     |
[stderr] |   1785                                                                      |
[stderr] |   1786         result = None                                                |
[stderr] |   1787         called_always_called_hooks = set()                           |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |         args = (                                                        | |
[stderr] | |                    tensor([[[-0.3906, -0.0898,  0.2305,  ..., -0.2373,  | |
[stderr] | |                0.1309, -0.3086]]],                                      | |
[stderr] | |                       dtype=torch.bfloat16, grad_fn=<AddBackward0>),    | |
[stderr] | |                )                                                        | |
[stderr] | | forward_call = <bound method GptOssDecoderLayer.forward of              | |
[stderr] | |                GptOssDecoderLayer(                                      | |
[stderr] | |                  (self_attn): GptOssAttention(                          | |
[stderr] | |                    (q_proj): Linear(in_features=2880,                   | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                    (k_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |                bias=True)                                               | |
[stderr] | |                    (v_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |                bias=True)                                               | |
[stderr] | |                    (o_proj): Linear(in_features=4096,                   | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (mlp): GptOssMLP(                                      | |
[stderr] | |                    (router): GptOssTopKRouter()                         | |
[stderr] | |                    (experts): GptOssExperts()                           | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)   | |
[stderr] | |                  (post_attention_layernorm): GptOssRMSNorm((2880,),     | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                )>                                                       | |
[stderr] | |       kwargs = {                                                        | |
[stderr] | |                    'attention_mask': tensor([[[[0., 0., 0., 0., 0., 0., | |
[stderr] | |                0., 0., 0., 0., 0., 0., 0.]]]],                          | |
[stderr] | |                       dtype=torch.bfloat16),                            | |
[stderr] | |                    'position_ids': tensor([[12]]),                      | |
[stderr] | |                    'past_key_values':                                   | |
[stderr] | |                DynamicCache(layers=[DynamicSlidingWindowLayer,          | |
[stderr] | |                DynamicLayer, DynamicSlidingWindowLayer, DynamicLayer,   | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer,                 | |
[stderr] | |                DynamicSlidingWindowLayer, DynamicLayer]),               | |
[stderr] | |                    'use_cache': True,                                   | |
[stderr] | |                    'cache_position': tensor([12]),                      | |
[stderr] | |                    'position_embeddings': (                             | |
[stderr] | |                        tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531,    | |
[stderr] | |                -1.2188, -0.3887,  0.3809,                               | |
[stderr] | |                           0.8516,  1.1016,  1.2500,  1.3125,  1.3359,   | |
[stderr] | |                1.3438,  1.3438,                                         | |
[stderr] | |                           1.3438,  1.3438,  1.3438,  1.3438,  1.3438,   | |
[stderr] | |                1.3438,  1.3438,                                         | |
[stderr] | |                           1.3438,  1.3438,  1.3438,  1.3438,  1.3438,   | |
[stderr] | |                1.3438,  1.3438,                                         | |
[stderr] | |                           1.3438,  1.3438,  1.3438,  1.3438]]],         | |
[stderr] | |                dtype=torch.bfloat16),                                   | |
[stderr] | |                        tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01, | |
[stderr] | |                -9.4922e-01,  5.7031e-01,                                | |
[stderr] | |                           1.2891e+00,  1.2891e+00,  1.0391e+00,         | |
[stderr] | |                7.6953e-01,  5.0000e-01,                                 | |
[stderr] | |                           3.1055e-01,  1.8652e-01,  1.0986e-01,         | |
[stderr] | |                6.2256e-02,  3.3936e-02,                                 | |
[stderr] | |                           1.6968e-02,  7.3853e-03,  2.0905e-03,         | |
[stderr] | |                6.1798e-04,  4.2725e-04,                                 | |
[stderr] | |                           2.9373e-04,  2.0218e-04,  1.3924e-04,         | |
[stderr] | |                9.6321e-05,  6.6280e-05,                                 | |
[stderr] | |                           4.5538e-05,  3.1471e-05,  2.1696e-05,         | |
[stderr] | |                1.4961e-05,  1.0312e-05,                                 | |
[stderr] | |                           7.0930e-06,  4.8876e-06]]],                   | |
[stderr] | |                dtype=torch.bfloat16)                                    | |
[stderr] | |                    ),                                                   | |
[stderr] | |                    'output_router_logits': False                        | |
[stderr] | |                }                                                        | |
[stderr] | |         self = GptOssDecoderLayer(                                      | |
[stderr] | |                  (self_attn): GptOssAttention(                          | |
[stderr] | |                    (q_proj): Linear(in_features=2880,                   | |
[stderr] | |                out_features=4096, bias=True)                            | |
[stderr] | |                    (k_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |                bias=True)                                               | |
[stderr] | |                    (v_proj): Linear(in_features=2880, out_features=512, | |
[stderr] | |                bias=True)                                               | |
[stderr] | |                    (o_proj): Linear(in_features=4096,                   | |
[stderr] | |                out_features=2880, bias=True)                            | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (mlp): GptOssMLP(                                      | |
[stderr] | |                    (router): GptOssTopKRouter()                         | |
[stderr] | |                    (experts): GptOssExperts()                           | |
[stderr] | |                  )                                                      | |
[stderr] | |                  (input_layernorm): GptOssRMSNorm((2880,), eps=1e-05)   | |
[stderr] | |                  (post_attention_layernorm): GptOssRMSNorm((2880,),     | |
[stderr] | |                eps=1e-05)                                               | |
[stderr] | |                )                                                        | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\utils\deprecation.py:172 in wrapped_func                          |
[stderr] |                                                                             |
[stderr] |   169                 # DeprecationWarning is ignored by default, so we use |
[stderr] |   170                 warnings.warn(message, FutureWarning, stacklevel=2)   |
[stderr] |   171                                                                       |
[stderr] | > 172             return func(*args, **kwargs)                              |
[stderr] |   173                                                                       |
[stderr] |   174         return wrapped_func                                           |
[stderr] |   175                                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |                additional_message = None                                | |
[stderr] | |                              args = (                                   | |
[stderr] | |                                         GptOssDecoderLayer(             | |
[stderr] | |                                       (self_attn): GptOssAttention(     | |
[stderr] | |                                         (q_proj):                       | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=4096, bias=True)       | |
[stderr] | |                                         (k_proj):                       | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=512, bias=True)        | |
[stderr] | |                                         (v_proj):                       | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=512, bias=True)        | |
[stderr] | |                                         (o_proj):                       | |
[stderr] | |                                     Linear(in_features=4096,            | |
[stderr] | |                                     out_features=2880, bias=True)       | |
[stderr] | |                                       )                                 | |
[stderr] | |                                       (mlp): GptOssMLP(                 | |
[stderr] | |                                         (router): GptOssTopKRouter()    | |
[stderr] | |                                         (experts): GptOssExperts()      | |
[stderr] | |                                       )                                 | |
[stderr] | |                                       (input_layernorm):                | |
[stderr] | |                                     GptOssRMSNorm((2880,), eps=1e-05)   | |
[stderr] | |                                       (post_attention_layernorm):       | |
[stderr] | |                                     GptOssRMSNorm((2880,), eps=1e-05)   | |
[stderr] | |                                     ),                                  | |
[stderr] | |                                         tensor([[[-0.3906, -0.0898,     | |
[stderr] | |                                     0.2305,  ..., -0.2373,  0.1309,     | |
[stderr] | |                                     -0.3086]]],                         | |
[stderr] | |                                            dtype=torch.bfloat16,        | |
[stderr] | |                                     grad_fn=<AddBackward0>)             | |
[stderr] | |                                     )                                   | |
[stderr] | |                         func_name = 'GptOssDecoderLayer.forward'        | |
[stderr] | |                   is_class_method = False                               | |
[stderr] | |       is_greater_or_equal_version = False                               | |
[stderr] | |                is_instance_method = True                                | |
[stderr] | |                            kwargs = {                                   | |
[stderr] | |                                         'attention_mask':               | |
[stderr] | |                                     tensor([[[[0., 0., 0., 0., 0., 0.,  | |
[stderr] | |                                     0., 0., 0., 0., 0., 0., 0.]]]],     | |
[stderr] | |                                            dtype=torch.bfloat16),       | |
[stderr] | |                                         'position_ids': tensor([[12]]), | |
[stderr] | |                                         'past_key_values':              | |
[stderr] | |                                     DynamicCache(layers=[DynamicSlidin… | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer,                       | |
[stderr] | |                                     DynamicSlidingWindowLayer,          | |
[stderr] | |                                     DynamicLayer]),                     | |
[stderr] | |                                         'use_cache': True,              | |
[stderr] | |                                         'cache_position': tensor([12]), | |
[stderr] | |                                         'position_embeddings': (        | |
[stderr] | |                                             tensor([[[ 1.1328, -0.5430, | |
[stderr] | |                                     1.1250, -0.9531, -1.2188, -0.3887,  | |
[stderr] | |                                     0.3809,                             | |
[stderr] | |                                                0.8516,  1.1016,         | |
[stderr] | |                                     1.2500,  1.3125,  1.3359,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438]]],                 | |
[stderr] | |                                     dtype=torch.bfloat16),              | |
[stderr] | |                                             tensor([[[-7.2266e-01,      | |
[stderr] | |                                     1.2344e+00, -7.4609e-01,            | |
[stderr] | |                                     -9.4922e-01,  5.7031e-01,           | |
[stderr] | |                                                1.2891e+00,  1.2891e+00, | |
[stderr] | |                                     1.0391e+00,  7.6953e-01,            | |
[stderr] | |                                     5.0000e-01,                         | |
[stderr] | |                                                3.1055e-01,  1.8652e-01, | |
[stderr] | |                                     1.0986e-01,  6.2256e-02,            | |
[stderr] | |                                     3.3936e-02,                         | |
[stderr] | |                                                1.6968e-02,  7.3853e-03, | |
[stderr] | |                                     2.0905e-03,  6.1798e-04,            | |
[stderr] | |                                     4.2725e-04,                         | |
[stderr] | |                                                2.9373e-04,  2.0218e-04, | |
[stderr] | |                                     1.3924e-04,  9.6321e-05,            | |
[stderr] | |                                     6.6280e-05,                         | |
[stderr] | |                                                4.5538e-05,  3.1471e-05, | |
[stderr] | |                                     2.1696e-05,  1.4961e-05,            | |
[stderr] | |                                     1.0312e-05,                         | |
[stderr] | |                                                7.0930e-06,              | |
[stderr] | |                                     4.8876e-06]]],                      | |
[stderr] | |                                     dtype=torch.bfloat16)               | |
[stderr] | |                                         ),                              | |
[stderr] | |                                         'output_router_logits': False   | |
[stderr] | |                                     }                                   | |
[stderr] | |                           message = None                                | |
[stderr] | |                    minimum_action = <Action.NONE: 'none'>               | |
[stderr] | |                          new_name = 'past_key_values'                   | |
[stderr] | |                          old_name = 'past_key_value'                    | |
[stderr] | |               raise_if_both_names = False                               | |
[stderr] | | raise_if_greater_or_equal_version = False                               | |
[stderr] | |                   version_message = 'and will be removed in version     | |
[stderr] | |                                     4.58'                               | |
[stderr] | |  warn_if_greater_or_equal_version = False                               | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\models\gpt_oss\modeling_gpt_oss.py:366 in forward                 |
[stderr] |                                                                             |
[stderr] |   363         residual = hidden_states                                      |
[stderr] |   364         hidden_states = self.input_layernorm(hidden_states)           |
[stderr] |   365         # Self Attention                                              |
[stderr] | > 366         hidden_states, _ = self.self_attn(                            |
[stderr] |   367             hidden_states=hidden_states,                              |
[stderr] |   368             attention_mask=attention_mask,                            |
[stderr] |   369             position_ids=position_ids,                                |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |      attention_mask = tensor([[[[0., 0., 0., 0., 0., 0., 0., 0., 0.,    | |
[stderr] | |                       0., 0., 0., 0.]]]],                               | |
[stderr] | |                              dtype=torch.bfloat16)                      | |
[stderr] | |      cache_position = tensor([12])                                      | |
[stderr] | |       hidden_states = tensor([[[-0.1953, -0.0391,  0.0840,  ...,        | |
[stderr] | |                       -0.2500,  0.1387, -0.1982]]],                     | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<ToCopyBackward0>)                        | |
[stderr] | |              kwargs = {'output_router_logits': False}                   | |
[stderr] | |     past_key_values = DynamicCache(layers=[DynamicSlidingWindowLayer,   | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer, DynamicSlidingWindowLayer,          | |
[stderr] | |                       DynamicLayer])                                    | |
[stderr] | | position_embeddings = (                                                 | |
[stderr] | |                           tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, | |
[stderr] | |                       -1.2188, -0.3887,  0.3809,                        | |
[stderr] | |                                  0.8516,  1.1016,  1.2500,  1.3125,     | |
[stderr] | |                       1.3359,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438]]],  | |
[stderr] | |                       dtype=torch.bfloat16),                            | |
[stderr] | |                           tensor([[[-7.2266e-01,  1.2344e+00,           | |
[stderr] | |                       -7.4609e-01, -9.4922e-01,  5.7031e-01,            | |
[stderr] | |                                  1.2891e+00,  1.2891e+00,  1.0391e+00,  | |
[stderr] | |                       7.6953e-01,  5.0000e-01,                          | |
[stderr] | |                                  3.1055e-01,  1.8652e-01,  1.0986e-01,  | |
[stderr] | |                       6.2256e-02,  3.3936e-02,                          | |
[stderr] | |                                  1.6968e-02,  7.3853e-03,  2.0905e-03,  | |
[stderr] | |                       6.1798e-04,  4.2725e-04,                          | |
[stderr] | |                                  2.9373e-04,  2.0218e-04,  1.3924e-04,  | |
[stderr] | |                       9.6321e-05,  6.6280e-05,                          | |
[stderr] | |                                  4.5538e-05,  3.1471e-05,  2.1696e-05,  | |
[stderr] | |                       1.4961e-05,  1.0312e-05,                          | |
[stderr] | |                                  7.0930e-06,  4.8876e-06]]],            | |
[stderr] | |                       dtype=torch.bfloat16)                             | |
[stderr] | |                       )                                                 | |
[stderr] | |        position_ids = tensor([[12]])                                    | |
[stderr] | |            residual = tensor([[[-0.3906, -0.0898,  0.2305,  ...,        | |
[stderr] | |                       -0.2373,  0.1309, -0.3086]]],                     | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<AddBackward0>)                           | |
[stderr] | |                self = GptOssDecoderLayer(                               | |
[stderr] | |                         (self_attn): GptOssAttention(                   | |
[stderr] | |                           (q_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=4096, bias=True)                     | |
[stderr] | |                           (k_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                           (v_proj): Linear(in_features=2880,            | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                           (o_proj): Linear(in_features=4096,            | |
[stderr] | |                       out_features=2880, bias=True)                     | |
[stderr] | |                         )                                               | |
[stderr] | |                         (mlp): GptOssMLP(                               | |
[stderr] | |                           (router): GptOssTopKRouter()                  | |
[stderr] | |                           (experts): GptOssExperts()                    | |
[stderr] | |                         )                                               | |
[stderr] | |                         (input_layernorm): GptOssRMSNorm((2880,),       | |
[stderr] | |                       eps=1e-05)                                        | |
[stderr] | |                         (post_attention_layernorm):                     | |
[stderr] | |                       GptOssRMSNorm((2880,), eps=1e-05)                 | |
[stderr] | |                       )                                                 | |
[stderr] | |           use_cache = True                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1773 in _wrapped_call_impl                          |
[stderr] |                                                                             |
[stderr] |   1770         if self._compiled_call_impl is not None:                     |
[stderr] |   1771             return self._compiled_call_impl(*args, **kwargs)  # type |
[stderr] |   1772         else:                                                        |
[stderr] | > 1773             return self._call_impl(*args, **kwargs)                  |
[stderr] |   1774                                                                      |
[stderr] |   1775     # torchrec tests the code consistency with the following code    |
[stderr] |   1776     # fmt: off                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = ()                                                             | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'hidden_states': tensor([[[-0.1953, -0.0391,  0.0840,      | |
[stderr] | |          ..., -0.2500,  0.1387, -0.1982]]],                             | |
[stderr] | |                 dtype=torch.bfloat16, grad_fn=<ToCopyBackward0>),       | |
[stderr] | |              'attention_mask': tensor([[[[0., 0., 0., 0., 0., 0., 0.,   | |
[stderr] | |          0., 0., 0., 0., 0., 0.]]]],                                    | |
[stderr] | |                 dtype=torch.bfloat16),                                  | |
[stderr] | |              'position_ids': tensor([[12]]),                            | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'use_cache': True,                                         | |
[stderr] | |              'cache_position': tensor([12]),                            | |
[stderr] | |              'position_embeddings': (                                   | |
[stderr] | |                  tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, -1.2188, | |
[stderr] | |          -0.3887,  0.3809,                                              | |
[stderr] | |                     0.8516,  1.1016,  1.2500,  1.3125,  1.3359,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438]]],               | |
[stderr] | |          dtype=torch.bfloat16),                                         | |
[stderr] | |                  tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01,       | |
[stderr] | |          -9.4922e-01,  5.7031e-01,                                      | |
[stderr] | |                     1.2891e+00,  1.2891e+00,  1.0391e+00,  7.6953e-01,  | |
[stderr] | |          5.0000e-01,                                                    | |
[stderr] | |                     3.1055e-01,  1.8652e-01,  1.0986e-01,  6.2256e-02,  | |
[stderr] | |          3.3936e-02,                                                    | |
[stderr] | |                     1.6968e-02,  7.3853e-03,  2.0905e-03,  6.1798e-04,  | |
[stderr] | |          4.2725e-04,                                                    | |
[stderr] | |                     2.9373e-04,  2.0218e-04,  1.3924e-04,  9.6321e-05,  | |
[stderr] | |          6.6280e-05,                                                    | |
[stderr] | |                     4.5538e-05,  3.1471e-05,  2.1696e-05,  1.4961e-05,  | |
[stderr] | |          1.0312e-05,                                                    | |
[stderr] | |                     7.0930e-06,  4.8876e-06]]], dtype=torch.bfloat16)   | |
[stderr] | |              ),                                                         | |
[stderr] | |              'output_router_logits': False                              | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssAttention(                                               | |
[stderr] | |            (q_proj): Linear(in_features=2880, out_features=4096,        | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (k_proj): Linear(in_features=2880, out_features=512,         | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (v_proj): Linear(in_features=2880, out_features=512,         | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (o_proj): Linear(in_features=4096, out_features=2880,        | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tor |
[stderr] | ch\nn\modules\module.py:1784 in _call_impl                                  |
[stderr] |                                                                             |
[stderr] |   1781         if not (self._backward_hooks or self._backward_pre_hooks or  |
[stderr] |   1782                 or _global_backward_pre_hooks or _global_backward_ho |
[stderr] |   1783                 or _global_forward_hooks or _global_forward_pre_hook |
[stderr] | > 1784             return forward_call(*args, **kwargs)                     |
[stderr] |   1785                                                                      |
[stderr] |   1786         result = None                                                |
[stderr] |   1787         called_always_called_hooks = set()                           |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |   args = ()                                                             | |
[stderr] | | kwargs = {                                                              | |
[stderr] | |              'hidden_states': tensor([[[-0.1953, -0.0391,  0.0840,      | |
[stderr] | |          ..., -0.2500,  0.1387, -0.1982]]],                             | |
[stderr] | |                 dtype=torch.bfloat16, grad_fn=<ToCopyBackward0>),       | |
[stderr] | |              'attention_mask': tensor([[[[0., 0., 0., 0., 0., 0., 0.,   | |
[stderr] | |          0., 0., 0., 0., 0., 0.]]]],                                    | |
[stderr] | |                 dtype=torch.bfloat16),                                  | |
[stderr] | |              'position_ids': tensor([[12]]),                            | |
[stderr] | |              'past_key_values':                                         | |
[stderr] | |          DynamicCache(layers=[DynamicSlidingWindowLayer, DynamicLayer,  | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer,                       | |
[stderr] | |          DynamicSlidingWindowLayer, DynamicLayer]),                     | |
[stderr] | |              'use_cache': True,                                         | |
[stderr] | |              'cache_position': tensor([12]),                            | |
[stderr] | |              'position_embeddings': (                                   | |
[stderr] | |                  tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, -1.2188, | |
[stderr] | |          -0.3887,  0.3809,                                              | |
[stderr] | |                     0.8516,  1.1016,  1.2500,  1.3125,  1.3359,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438,  1.3438,         | |
[stderr] | |          1.3438,  1.3438,                                               | |
[stderr] | |                     1.3438,  1.3438,  1.3438,  1.3438]]],               | |
[stderr] | |          dtype=torch.bfloat16),                                         | |
[stderr] | |                  tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01,       | |
[stderr] | |          -9.4922e-01,  5.7031e-01,                                      | |
[stderr] | |                     1.2891e+00,  1.2891e+00,  1.0391e+00,  7.6953e-01,  | |
[stderr] | |          5.0000e-01,                                                    | |
[stderr] | |                     3.1055e-01,  1.8652e-01,  1.0986e-01,  6.2256e-02,  | |
[stderr] | |          3.3936e-02,                                                    | |
[stderr] | |                     1.6968e-02,  7.3853e-03,  2.0905e-03,  6.1798e-04,  | |
[stderr] | |          4.2725e-04,                                                    | |
[stderr] | |                     2.9373e-04,  2.0218e-04,  1.3924e-04,  9.6321e-05,  | |
[stderr] | |          6.6280e-05,                                                    | |
[stderr] | |                     4.5538e-05,  3.1471e-05,  2.1696e-05,  1.4961e-05,  | |
[stderr] | |          1.0312e-05,                                                    | |
[stderr] | |                     7.0930e-06,  4.8876e-06]]], dtype=torch.bfloat16)   | |
[stderr] | |              ),                                                         | |
[stderr] | |              'output_router_logits': False                              | |
[stderr] | |          }                                                              | |
[stderr] | |   self = GptOssAttention(                                               | |
[stderr] | |            (q_proj): Linear(in_features=2880, out_features=4096,        | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (k_proj): Linear(in_features=2880, out_features=512,         | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (v_proj): Linear(in_features=2880, out_features=512,         | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |            (o_proj): Linear(in_features=4096, out_features=2880,        | |
[stderr] | |          bias=True)                                                     | |
[stderr] | |          )                                                              | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | G:\OSSC\gpt_oss_ws\attention_patch.py:188 in patched_forward                |
[stderr] |                                                                             |
[stderr] |   185             elif target_key == "past_key_value":                      |
[stderr] |   186               bound.arguments.pop("past_key_values", None)            |
[stderr] |   187                                                                       |
[stderr] | > 188       if toggles.kv_append and virtual_k is not None and accepts_atte |
[stderr] |   189         attention_mask = bound.arguments.get("attention_mask")        |
[stderr] |   190         bound.arguments["attention_mask"] = _extend_mask(attention_ma |
[stderr] |   191                                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | | accepts_attention_mask = True                                           | |
[stderr] | |     accepts_past_value = False                                          | |
[stderr] | |    accepts_past_values = True                                           | |
[stderr] | |                   args = ()                                             | |
[stderr] | |         attention_mask = tensor([[[[0., 0., 0., 0., 0., 0., 0., 0., 0., | |
[stderr] | |                          0., 0., 0., 0.]]]],                            | |
[stderr] | |                                 dtype=torch.bfloat16)                   | |
[stderr] | |             base_cache = DynamicCache(layers=[DynamicSlidingWindowLaye… | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer])                                 | |
[stderr] | |                  bound = <BoundArguments                                | |
[stderr] | |                          (hidden_states=tensor([[[-0.1953, -0.0391,     | |
[stderr] | |                          0.0840,  ..., -0.2500,  0.1387, -0.1982]]],    | |
[stderr] | |                                 dtype=torch.bfloat16,                   | |
[stderr] | |                          grad_fn=<ToCopyBackward0>),                    | |
[stderr] | |                          position_embeddings=(tensor([[[ 1.1328,        | |
[stderr] | |                          -0.5430,  1.1250, -0.9531, -1.2188, -0.3887,   | |
[stderr] | |                          0.3809,                                        | |
[stderr] | |                                     0.8516,  1.1016,  1.2500,  1.3125,  | |
[stderr] | |                          1.3359,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                          1.3438,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                          1.3438,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,           | |
[stderr] | |                          1.3438]]], dtype=torch.bfloat16),              | |
[stderr] | |                          tensor([[[-7.2266e-01,  1.2344e+00,            | |
[stderr] | |                          -7.4609e-01, -9.4922e-01,  5.7031e-01,         | |
[stderr] | |                                     1.2891e+00,  1.2891e+00,            | |
[stderr] | |                          1.0391e+00,  7.6953e-01,  5.0000e-01,          | |
[stderr] | |                                     3.1055e-01,  1.8652e-01,            | |
[stderr] | |                          1.0986e-01,  6.2256e-02,  3.3936e-02,          | |
[stderr] | |                                     1.6968e-02,  7.3853e-03,            | |
[stderr] | |                          2.0905e-03,  6.1798e-04,  4.2725e-04,          | |
[stderr] | |                                     2.9373e-04,  2.0218e-04,            | |
[stderr] | |                          1.3924e-04,  9.6321e-05,  6.6280e-05,          | |
[stderr] | |                                     4.5538e-05,  3.1471e-05,            | |
[stderr] | |                          2.1696e-05,  1.4961e-05,  1.0312e-05,          | |
[stderr] | |                                     7.0930e-06,  4.8876e-06]]],         | |
[stderr] | |                          dtype=torch.bfloat16)),                        | |
[stderr] | |                          attention_mask=tensor([[[[0., 0., 0., 0., 0.,  | |
[stderr] | |                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,    | |
[stderr] | |                          0.]]]]),                                       | |
[stderr] | |                          past_key_values=<gpt_oss_ws.attention_patch._… | |
[stderr] | |                          object at 0x00000265383C1FD0>,                 | |
[stderr] | |                          cache_position=tensor([12]),                   | |
[stderr] | |                          kwargs={'position_ids': tensor([[12]]),        | |
[stderr] | |                          'use_cache': True, 'output_router_logits':     | |
[stderr] | |                          False})>                                       | |
[stderr] | |                 device = 'cpu'                                          | |
[stderr] | |         expected_dtype = torch.bfloat16                                 | |
[stderr] | |                fetched = (                                              | |
[stderr] | |                              tensor([[[[0., 0., 0.,  ..., 0., 0., 0.],  | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   ...,                                  | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]]]],   | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                                 grad_fn=<CatBackward0>),                | |
[stderr] | |                              tensor([[[[0., 0., 0.,  ..., 0., 0., 0.],  | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   ...,                                  | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]]]],   | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                                 grad_fn=<CatBackward0>)                 | |
[stderr] | |                          )                                              | |
[stderr] | |      hidden_states_arg = tensor([[[-0.1953, -0.0391,  0.0840,  ...,     | |
[stderr] | |                          -0.2500,  0.1387, -0.1982]]],                  | |
[stderr] | |                                 dtype=torch.bfloat16,                   | |
[stderr] | |                          grad_fn=<ToCopyBackward0>)                     | |
[stderr] | |                 kwargs = {                                              | |
[stderr] | |                              'hidden_states': tensor([[[-0.1953,        | |
[stderr] | |                          -0.0391,  0.0840,  ..., -0.2500,  0.1387,      | |
[stderr] | |                          -0.1982]]],                                    | |
[stderr] | |                                 dtype=torch.bfloat16,                   | |
[stderr] | |                          grad_fn=<ToCopyBackward0>),                    | |
[stderr] | |                              'attention_mask': tensor([[[[0., 0., 0.,   | |
[stderr] | |                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]]],    | |
[stderr] | |                                 dtype=torch.bfloat16),                  | |
[stderr] | |                              'position_ids': tensor([[12]]),            | |
[stderr] | |                              'past_key_values':                         | |
[stderr] | |                          DynamicCache(layers=[DynamicSlidingWindowLaye… | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer]),                                | |
[stderr] | |                              'use_cache': True,                         | |
[stderr] | |                              'cache_position': tensor([12]),            | |
[stderr] | |                              'position_embeddings': (                   | |
[stderr] | |                                  tensor([[[ 1.1328, -0.5430,  1.1250,   | |
[stderr] | |                          -0.9531, -1.2188, -0.3887,  0.3809,            | |
[stderr] | |                                     0.8516,  1.1016,  1.2500,  1.3125,  | |
[stderr] | |                          1.3359,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                          1.3438,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                          1.3438,  1.3438,  1.3438,                      | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,           | |
[stderr] | |                          1.3438]]], dtype=torch.bfloat16),              | |
[stderr] | |                                  tensor([[[-7.2266e-01,  1.2344e+00,    | |
[stderr] | |                          -7.4609e-01, -9.4922e-01,  5.7031e-01,         | |
[stderr] | |                                     1.2891e+00,  1.2891e+00,            | |
[stderr] | |                          1.0391e+00,  7.6953e-01,  5.0000e-01,          | |
[stderr] | |                                     3.1055e-01,  1.8652e-01,            | |
[stderr] | |                          1.0986e-01,  6.2256e-02,  3.3936e-02,          | |
[stderr] | |                                     1.6968e-02,  7.3853e-03,            | |
[stderr] | |                          2.0905e-03,  6.1798e-04,  4.2725e-04,          | |
[stderr] | |                                     2.9373e-04,  2.0218e-04,            | |
[stderr] | |                          1.3924e-04,  9.6321e-05,  6.6280e-05,          | |
[stderr] | |                                     4.5538e-05,  3.1471e-05,            | |
[stderr] | |                          2.1696e-05,  1.4961e-05,  1.0312e-05,          | |
[stderr] | |                                     7.0930e-06,  4.8876e-06]]],         | |
[stderr] | |                          dtype=torch.bfloat16)                          | |
[stderr] | |                              ),                                         | |
[stderr] | |                              'output_router_logits': False              | |
[stderr] | |                          }                                              | |
[stderr] | |       original_forward = <bound method GptOssAttention.forward of       | |
[stderr] | |                          GptOssAttention(                               | |
[stderr] | |                            (q_proj): Linear(in_features=2880,           | |
[stderr] | |                          out_features=4096, bias=True)                  | |
[stderr] | |                            (k_proj): Linear(in_features=2880,           | |
[stderr] | |                          out_features=512, bias=True)                   | |
[stderr] | |                            (v_proj): Linear(in_features=2880,           | |
[stderr] | |                          out_features=512, bias=True)                   | |
[stderr] | |                            (o_proj): Linear(in_features=4096,           | |
[stderr] | |                          out_features=2880, bias=True)                  | |
[stderr] | |                          )>                                             | |
[stderr] | |                   past = DynamicCache(layers=[DynamicSlidingWindowLaye… | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer, DynamicSlidingWindowLayer,       | |
[stderr] | |                          DynamicLayer])                                 | |
[stderr] | |          past_arg_name = 'past_key_values'                              | |
[stderr] | |                runtime = WorkspaceRuntimeState(                         | |
[stderr] | |                              toggles=HookToggles(                       | |
[stderr] | |                                  kv_append=True,                        | |
[stderr] | |                                  residual_delta=True,                   | |
[stderr] | |                                  read_probes=True,                      | |
[stderr] | |                                  broadcast=True                         | |
[stderr] | |                              ),                                         | |
[stderr] | |                              layer_map={},                              | |
[stderr] | |                              kv_fetch=<bound method                     | |
[stderr] | |                          GPTOSSHookedModel._kv_fetch of                 | |
[stderr] | |                          <gpt_oss_ws.model_wrapper.GPTOSSHookedModel    | |
[stderr] | |                          object at 0x00000263334406E0>>,                | |
[stderr] | |                              residual_delta=<bound method               | |
[stderr] | |                          GPTOSSHookedModel._residual_delta of           | |
[stderr] | |                          <gpt_oss_ws.model_wrapper.GPTOSSHookedModel    | |
[stderr] | |                          object at 0x00000263334406E0>>,                | |
[stderr] | |                              record_residual=<bound method              | |
[stderr] | |                          GPTOSSHookedModel._record_residual of          | |
[stderr] | |                          <gpt_oss_ws.model_wrapper.GPTOSSHookedModel    | |
[stderr] | |                          object at 0x00000263334406E0>>,                | |
[stderr] | |                              post_attention_hook=None,                  | |
[stderr] | |                              device='cpu',                              | |
[stderr] | |                              slots=tensor([[[ 0.8571, -0.0400,  0.6032, | |
[stderr] | |                          ..., -1.2922,  0.4311,  1.5385],               | |
[stderr] | |                                   [ 0.7043, -0.1188,  0.2911,  ...,     | |
[stderr] | |                          -0.5250, -0.8926,  0.3364],                    | |
[stderr] | |                                   [ 0.9002, -1.3551,  0.5654,  ...,     | |
[stderr] | |                          0.1557,  0.3462,  0.7743],                     | |
[stderr] | |                                   [ 1.0015, -0.0597,  0.5769,  ...,     | |
[stderr] | |                          -0.0745, -0.3858,  0.9396],                    | |
[stderr] | |                                   [ 1.3615,  0.2206, -0.4275,  ...,     | |
[stderr] | |                          -0.9733,  0.0503,  0.9401],                    | |
[stderr] | |                                   [ 1.0800,  0.3761, -0.0934,  ...,     | |
[stderr] | |                          -0.8194,  0.2217,  0.6753]]],                  | |
[stderr] | |                                 grad_fn=<AddBackward0>),                | |
[stderr] | |                              entropy=5.34375                            | |
[stderr] | |                          )                                              | |
[stderr] | |                   self = <gpt_oss_ws.attention_patch.AttentionPatcher   | |
[stderr] | |                          object at 0x00000265383C1550>                  | |
[stderr] | |              signature = <Signature (hidden_states: torch.Tensor,       | |
[stderr] | |                          position_embeddings: tuple[torch.Tensor,       | |
[stderr] | |                          torch.Tensor], attention_mask:                 | |
[stderr] | |                          Optional[torch.Tensor], past_key_values:       | |
[stderr] | |                          Optional[transformers.cache_utils.Cache] =     | |
[stderr] | |                          None, cache_position:                          | |
[stderr] | |                          Optional[torch.LongTensor] = None, **kwargs:   | |
[stderr] | |                          Unpack[transformers.utils.generic.Transformer… | |
[stderr] | |                          -> tuple[torch.Tensor, torch.Tensor]>          | |
[stderr] | |             target_key = 'past_key_values'                              | |
[stderr] | |                toggles = HookToggles(                                   | |
[stderr] | |                              kv_append=True,                            | |
[stderr] | |                              residual_delta=True,                       | |
[stderr] | |                              read_probes=True,                          | |
[stderr] | |                              broadcast=True                             | |
[stderr] | |                          )                                              | |
[stderr] | |              virtual_k = tensor([[[[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   ...,                                  | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]]]],   | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                                 grad_fn=<CatBackward0>)                 | |
[stderr] | |              virtual_v = tensor([[[[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   ...,                                  | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]],     | |
[stderr] | |                                                                         | |
[stderr] | |                                   [[0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.],      | |
[stderr] | |                                    [0., 0., 0.,  ..., 0., 0., 0.]]]],   | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                                 grad_fn=<CatBackward0>)                 | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\utils\deprecation.py:172 in wrapped_func                          |
[stderr] |                                                                             |
[stderr] |   169                 # DeprecationWarning is ignored by default, so we use |
[stderr] |   170                 warnings.warn(message, FutureWarning, stacklevel=2)   |
[stderr] |   171                                                                       |
[stderr] | > 172             return func(*args, **kwargs)                              |
[stderr] |   173                                                                       |
[stderr] |   174         return wrapped_func                                           |
[stderr] |   175                                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |                additional_message = None                                | |
[stderr] | |                              args = (                                   | |
[stderr] | |                                         GptOssAttention(                | |
[stderr] | |                                       (q_proj):                         | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=4096, bias=True)       | |
[stderr] | |                                       (k_proj):                         | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=512, bias=True)        | |
[stderr] | |                                       (v_proj):                         | |
[stderr] | |                                     Linear(in_features=2880,            | |
[stderr] | |                                     out_features=512, bias=True)        | |
[stderr] | |                                       (o_proj):                         | |
[stderr] | |                                     Linear(in_features=4096,            | |
[stderr] | |                                     out_features=2880, bias=True)       | |
[stderr] | |                                     ),                                  | |
[stderr] | |                                         tensor([[[-0.1953, -0.0391,     | |
[stderr] | |                                     0.0840,  ..., -0.2500,  0.1387,     | |
[stderr] | |                                     -0.1982]]],                         | |
[stderr] | |                                            dtype=torch.bfloat16,        | |
[stderr] | |                                     grad_fn=<ToCopyBackward0>),         | |
[stderr] | |                                         (                               | |
[stderr] | |                                             tensor([[[ 1.1328, -0.5430, | |
[stderr] | |                                     1.1250, -0.9531, -1.2188, -0.3887,  | |
[stderr] | |                                     0.3809,                             | |
[stderr] | |                                                0.8516,  1.1016,         | |
[stderr] | |                                     1.2500,  1.3125,  1.3359,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438,  1.3438,  1.3438,  | |
[stderr] | |                                     1.3438,                             | |
[stderr] | |                                                1.3438,  1.3438,         | |
[stderr] | |                                     1.3438,  1.3438]]],                 | |
[stderr] | |                                     dtype=torch.bfloat16),              | |
[stderr] | |                                             tensor([[[-7.2266e-01,      | |
[stderr] | |                                     1.2344e+00, -7.4609e-01,            | |
[stderr] | |                                     -9.4922e-01,  5.7031e-01,           | |
[stderr] | |                                                1.2891e+00,  1.2891e+00, | |
[stderr] | |                                     1.0391e+00,  7.6953e-01,            | |
[stderr] | |                                     5.0000e-01,                         | |
[stderr] | |                                                3.1055e-01,  1.8652e-01, | |
[stderr] | |                                     1.0986e-01,  6.2256e-02,            | |
[stderr] | |                                     3.3936e-02,                         | |
[stderr] | |                                                1.6968e-02,  7.3853e-03, | |
[stderr] | |                                     2.0905e-03,  6.1798e-04,            | |
[stderr] | |                                     4.2725e-04,                         | |
[stderr] | |                                                2.9373e-04,  2.0218e-04, | |
[stderr] | |                                     1.3924e-04,  9.6321e-05,            | |
[stderr] | |                                     6.6280e-05,                         | |
[stderr] | |                                                4.5538e-05,  3.1471e-05, | |
[stderr] | |                                     2.1696e-05,  1.4961e-05,            | |
[stderr] | |                                     1.0312e-05,                         | |
[stderr] | |                                                7.0930e-06,              | |
[stderr] | |                                     4.8876e-06]]],                      | |
[stderr] | |                                     dtype=torch.bfloat16)               | |
[stderr] | |                                         ),                              | |
[stderr] | |                                         tensor([[[[0., 0., 0., 0., 0.,  | |
[stderr] | |                                     0., 0., 0., 0., 0., 0., 0., 0., 0., | |
[stderr] | |                                     0., 0., 0.]]]]),                    | |
[stderr] | |                                         <gpt_oss_ws.attention_patch._V… | |
[stderr] | |                                     object at 0x00000265383C1FD0>,      | |
[stderr] | |                                         tensor([12])                    | |
[stderr] | |                                     )                                   | |
[stderr] | |                         func_name = 'GptOssAttention.forward'           | |
[stderr] | |                   is_class_method = False                               | |
[stderr] | |       is_greater_or_equal_version = False                               | |
[stderr] | |                is_instance_method = True                                | |
[stderr] | |                            kwargs = {                                   | |
[stderr] | |                                         'position_ids': tensor([[12]]), | |
[stderr] | |                                         'use_cache': True,              | |
[stderr] | |                                         'output_router_logits': False   | |
[stderr] | |                                     }                                   | |
[stderr] | |                           message = None                                | |
[stderr] | |                    minimum_action = <Action.NONE: 'none'>               | |
[stderr] | |                          new_name = 'past_key_values'                   | |
[stderr] | |                          old_name = 'past_key_value'                    | |
[stderr] | |               raise_if_both_names = False                               | |
[stderr] | | raise_if_greater_or_equal_version = False                               | |
[stderr] | |                   version_message = 'and will be removed in version     | |
[stderr] | |                                     4.58'                               | |
[stderr] | |  warn_if_greater_or_equal_version = False                               | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\models\gpt_oss\modeling_gpt_oss.py:323 in forward                 |
[stderr] |                                                                             |
[stderr] |   320         if self.config._attn_implementation != "eager":               |
[stderr] |   321             attention_interface = ALL_ATTENTION_FUNCTIONS[self.config |
[stderr] |   322                                                                       |
[stderr] | > 323         attn_output, attn_weights = attention_interface(              |
[stderr] |   324             self,                                                     |
[stderr] |   325             query_states,                                             |
[stderr] |   326             key_states,                                               |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |      attention_mask = tensor([[[[0., 0., 0., 0., 0., 0., 0., 0., 0.,    | |
[stderr] | |                       0., 0., 0., 0., 0., 0., 0., 0.]]]])               | |
[stderr] | |        cache_kwargs = {'cache_position': tensor([12])}                  | |
[stderr] | |      cache_position = tensor([12])                                      | |
[stderr] | |                 cos = tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531,     | |
[stderr] | |                       -1.2188, -0.3887,  0.3809,                        | |
[stderr] | |                                  0.8516,  1.1016,  1.2500,  1.3125,     | |
[stderr] | |                       1.3359,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438]]],  | |
[stderr] | |                       dtype=torch.bfloat16)                             | |
[stderr] | |        hidden_shape = (1, 1, -1, 64)                                    | |
[stderr] | |       hidden_states = tensor([[[-0.1953, -0.0391,  0.0840,  ...,        | |
[stderr] | |                       -0.2500,  0.1387, -0.1982]]],                     | |
[stderr] | |                              dtype=torch.bfloat16,                      | |
[stderr] | |                       grad_fn=<ToCopyBackward0>)                        | |
[stderr] | |         input_shape = torch.Size([1, 1])                                | |
[stderr] | |          key_states = tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [-2.1250e+00,  1.0391e+00, -2.9062e+00, | |
[stderr] | |                       ..., -7.4158e-03,                                 | |
[stderr] | |                                  -1.6797e+00, -1.0469e+00],             | |
[stderr] | |                                 [-8.2812e-01,  4.8828e-02, -5.9766e-01, | |
[stderr] | |                       ..., -1.2812e+00,                                 | |
[stderr] | |                                   1.0859e+00,  2.2344e+00],             | |
[stderr] | |                                 [-4.1406e-01, -4.1992e-01, -1.4453e+00, | |
[stderr] | |                       ..., -5.0000e+00,                                 | |
[stderr] | |                                   8.7109e-01, -1.6094e+00]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 1.2500e+01,  2.7188e+00,  4.7070e-01, | |
[stderr] | |                       ..., -3.4375e+00,                                 | |
[stderr] | |                                  -7.0312e-01, -1.9297e+00],             | |
[stderr] | |                                 [-3.9648e-01, -2.2812e+00, -2.9102e-01, | |
[stderr] | |                       ..., -1.6875e+00,                                 | |
[stderr] | |                                  -1.0078e+00,  6.2891e-01],             | |
[stderr] | |                                 [-1.1688e+01, -4.0312e+00, -9.6875e-01, | |
[stderr] | |                       ..., -3.2812e+00,                                 | |
[stderr] | |                                  -1.9844e+00,  5.4688e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [-2.6367e-01,  2.1680e-01, -1.1328e+00, | |
[stderr] | |                       ..., -8.3594e-01,                                 | |
[stderr] | |                                  -2.5469e+00,  8.5156e-01],             | |
[stderr] | |                                 [-1.0132e-02,  6.3965e-02, -1.8799e-02, | |
[stderr] | |                       ...,  2.5938e+00,                                 | |
[stderr] | |                                   2.1875e+00, -1.6357e-02],             | |
[stderr] | |                                 [-3.0859e-01, -4.2969e-01, -1.4844e-01, | |
[stderr] | |                       ..., -6.2109e-01,                                 | |
[stderr] | |                                  -1.1719e+00, -2.3906e+00]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                ...,                                     | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [-1.3672e+00, -1.7969e+00, -2.2344e+00, | |
[stderr] | |                       ..., -8.1250e-01,                                 | |
[stderr] | |                                  -1.7734e+00, -5.6641e-01],             | |
[stderr] | |                                 [-2.0996e-01,  1.1816e-01, -4.7852e-02, | |
[stderr] | |                       ...,  6.2109e-01,                                 | |
[stderr] | |                                  -1.5625e+00, -2.7344e+00],             | |
[stderr] | |                                 [-1.8164e-01,  2.6953e-01, -5.8203e-01, | |
[stderr] | |                       ..., -1.0859e+00,                                 | |
[stderr] | |                                  -1.8125e+00, -2.6562e+00]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 3.9062e-03, -1.2812e+00, -6.9141e-01, | |
[stderr] | |                       ...,  3.9844e+00,                                 | |
[stderr] | |                                  -4.7812e+00,  2.6875e+00],             | |
[stderr] | |                                 [ 5.6641e-01, -9.4238e-02, -1.4258e-01, | |
[stderr] | |                       ..., -1.0000e+00,                                 | |
[stderr] | |                                   5.0000e-01,  1.4609e+00],             | |
[stderr] | |                                 [ 6.8359e-01,  1.3086e-01,  3.2422e-01, | |
[stderr] | |                       ..., -2.6953e-01,                                 | |
[stderr] | |                                   9.2285e-02, -5.0625e+00]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [-1.7734e+00,  2.3438e-01,  2.5000e+00, | |
[stderr] | |                       ..., -1.2891e+00,                                 | |
[stderr] | |                                  -1.6504e-01,  1.2109e+00],             | |
[stderr] | |                                 [ 1.2344e+00, -3.6133e-01,  7.0312e-01, | |
[stderr] | |                       ...,  6.4844e-01,                                 | |
[stderr] | |                                  -1.1523e-01, -1.6094e+00],             | |
[stderr] | |                                 [ 1.5000e+00, -1.1250e+00,  8.0078e-02, | |
[stderr] | |                       ..., -2.1250e+00,                                 | |
[stderr] | |                                   2.3125e+00, -8.8379e-02]]]],          | |
[stderr] | |                       dtype=torch.bfloat16,                             | |
[stderr] | |                              grad_fn=<CatBackward0>)                    | |
[stderr] | |              kwargs = {                                                 | |
[stderr] | |                           'position_ids': tensor([[12]]),               | |
[stderr] | |                           'use_cache': True,                            | |
[stderr] | |                           'output_router_logits': False                 | |
[stderr] | |                       }                                                 | |
[stderr] | |     past_key_values = <gpt_oss_ws.attention_patch._VirtualCacheProxy    | |
[stderr] | |                       object at 0x00000265383C1FD0>                     | |
[stderr] | | position_embeddings = (                                                 | |
[stderr] | |                           tensor([[[ 1.1328, -0.5430,  1.1250, -0.9531, | |
[stderr] | |                       -1.2188, -0.3887,  0.3809,                        | |
[stderr] | |                                  0.8516,  1.1016,  1.2500,  1.3125,     | |
[stderr] | |                       1.3359,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438,     | |
[stderr] | |                       1.3438,  1.3438,  1.3438,                         | |
[stderr] | |                                  1.3438,  1.3438,  1.3438,  1.3438]]],  | |
[stderr] | |                       dtype=torch.bfloat16),                            | |
[stderr] | |                           tensor([[[-7.2266e-01,  1.2344e+00,           | |
[stderr] | |                       -7.4609e-01, -9.4922e-01,  5.7031e-01,            | |
[stderr] | |                                  1.2891e+00,  1.2891e+00,  1.0391e+00,  | |
[stderr] | |                       7.6953e-01,  5.0000e-01,                          | |
[stderr] | |                                  3.1055e-01,  1.8652e-01,  1.0986e-01,  | |
[stderr] | |                       6.2256e-02,  3.3936e-02,                          | |
[stderr] | |                                  1.6968e-02,  7.3853e-03,  2.0905e-03,  | |
[stderr] | |                       6.1798e-04,  4.2725e-04,                          | |
[stderr] | |                                  2.9373e-04,  2.0218e-04,  1.3924e-04,  | |
[stderr] | |                       9.6321e-05,  6.6280e-05,                          | |
[stderr] | |                                  4.5538e-05,  3.1471e-05,  2.1696e-05,  | |
[stderr] | |                       1.4961e-05,  1.0312e-05,                          | |
[stderr] | |                                  7.0930e-06,  4.8876e-06]]],            | |
[stderr] | |                       dtype=torch.bfloat16)                             | |
[stderr] | |                       )                                                 | |
[stderr] | |        query_states = tensor([[[[ 5.6152e-02,  3.8477e-01, -1.9531e-01, | |
[stderr] | |                       ...,  6.1719e-01,                                 | |
[stderr] | |                                   1.6797e+00, -6.5625e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 5.6641e-02,  3.3594e-01, -1.4648e-03, | |
[stderr] | |                       ...,  5.8594e-01,                                 | |
[stderr] | |                                   1.3750e+00,  4.1016e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[-3.3447e-02,  4.4922e-02, -1.5991e-02, | |
[stderr] | |                       ..., -1.6172e+00,                                 | |
[stderr] | |                                   7.0312e-01,  7.3047e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                ...,                                     | |
[stderr] | |                                                                         | |
[stderr] | |                                [[-1.0205e-01, -4.1992e-02, -1.1621e-01, | |
[stderr] | |                       ...,  3.9688e+00,                                 | |
[stderr] | |                                   7.1875e-01, -5.0781e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 5.4688e-02, -1.0840e-01,  4.7266e-01, | |
[stderr] | |                       ...,  4.8242e-01,                                 | |
[stderr] | |                                  -1.7285e-01,  1.3516e+00]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[-7.7148e-02, -5.6250e-01, -9.5312e-01, | |
[stderr] | |                       ...,  2.8906e+00,                                 | |
[stderr] | |                                  -4.5898e-01,  7.5000e-01]]]],          | |
[stderr] | |                       dtype=torch.bfloat16,                             | |
[stderr] | |                              grad_fn=<CatBackward0>)                    | |
[stderr] | |                self = GptOssAttention(                                  | |
[stderr] | |                         (q_proj): Linear(in_features=2880,              | |
[stderr] | |                       out_features=4096, bias=True)                     | |
[stderr] | |                         (k_proj): Linear(in_features=2880,              | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                         (v_proj): Linear(in_features=2880,              | |
[stderr] | |                       out_features=512, bias=True)                      | |
[stderr] | |                         (o_proj): Linear(in_features=4096,              | |
[stderr] | |                       out_features=2880, bias=True)                     | |
[stderr] | |                       )                                                 | |
[stderr] | |                 sin = tensor([[[-7.2266e-01,  1.2344e+00, -7.4609e-01,  | |
[stderr] | |                       -9.4922e-01,  5.7031e-01,                         | |
[stderr] | |                                  1.2891e+00,  1.2891e+00,  1.0391e+00,  | |
[stderr] | |                       7.6953e-01,  5.0000e-01,                          | |
[stderr] | |                                  3.1055e-01,  1.8652e-01,  1.0986e-01,  | |
[stderr] | |                       6.2256e-02,  3.3936e-02,                          | |
[stderr] | |                                  1.6968e-02,  7.3853e-03,  2.0905e-03,  | |
[stderr] | |                       6.1798e-04,  4.2725e-04,                          | |
[stderr] | |                                  2.9373e-04,  2.0218e-04,  1.3924e-04,  | |
[stderr] | |                       9.6321e-05,  6.6280e-05,                          | |
[stderr] | |                                  4.5538e-05,  3.1471e-05,  2.1696e-05,  | |
[stderr] | |                       1.4961e-05,  1.0312e-05,                          | |
[stderr] | |                                  7.0930e-06,  4.8876e-06]]],            | |
[stderr] | |                       dtype=torch.bfloat16)                             | |
[stderr] | |        value_states = tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 9.2578e-01, -5.0391e-01, -1.3203e+00, | |
[stderr] | |                       ...,  2.1562e+00,                                 | |
[stderr] | |                                  -1.1953e+00, -1.7656e+00],             | |
[stderr] | |                                 [-1.4844e+00, -7.2656e-01,  7.1484e-01, | |
[stderr] | |                       ...,  7.1289e-02,                                 | |
[stderr] | |                                  -6.4062e-01, -1.1169e-02],             | |
[stderr] | |                                 [-5.5859e-01,  2.4219e+00,  1.5938e+00, | |
[stderr] | |                       ...,  1.6641e+00,                                 | |
[stderr] | |                                   1.1328e+00, -5.0000e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 3.3447e-02,  1.7500e+00, -5.7031e-01, | |
[stderr] | |                       ..., -3.1250e-01,                                 | |
[stderr] | |                                  -3.3008e-01,  6.6797e-01],             | |
[stderr] | |                                 [-1.0938e+00,  4.9023e-01, -6.2500e-01, | |
[stderr] | |                       ..., -1.2256e-01,                                 | |
[stderr] | |                                  -9.7656e-01,  2.0312e-01],             | |
[stderr] | |                                 [-2.6875e+00,  1.2500e+00, -3.1128e-02, | |
[stderr] | |                       ..., -3.2031e-01,                                 | |
[stderr] | |                                  -1.3281e+00,  2.5781e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 7.2754e-02, -3.5938e-01,  9.8438e-01, | |
[stderr] | |                       ..., -2.0312e+00,                                 | |
[stderr] | |                                  -1.2578e+00, -8.6719e-01],             | |
[stderr] | |                                 [ 1.2891e+00, -2.5781e-01, -1.7480e-01, | |
[stderr] | |                       ..., -6.1719e-01,                                 | |
[stderr] | |                                   4.1797e-01, -3.2617e-01],             | |
[stderr] | |                                 [ 7.3047e-01, -3.9062e-01,  2.8320e-01, | |
[stderr] | |                       ..., -1.1406e+00,                                 | |
[stderr] | |                                   3.5547e-01, -8.7402e-02]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                ...,                                     | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 5.6250e-01,  1.6406e-01,  2.6855e-03, | |
[stderr] | |                       ...,  4.6484e-01,                                 | |
[stderr] | |                                   8.2031e-01, -1.0938e+00],             | |
[stderr] | |                                 [ 1.0156e-01, -2.2852e-01,  8.9844e-01, | |
[stderr] | |                       ..., -2.8711e-01,                                 | |
[stderr] | |                                   1.3770e-01, -8.1250e-01],             | |
[stderr] | |                                 [-4.1602e-01,  3.9258e-01,  3.1445e-01, | |
[stderr] | |                       ...,  5.6641e-01,                                 | |
[stderr] | |                                   4.3359e-01, -7.8906e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 2.7969e+00,  1.0693e-01, -1.3672e+00, | |
[stderr] | |                       ..., -2.8125e+00,                                 | |
[stderr] | |                                   1.5747e-02,  1.7422e+00],             | |
[stderr] | |                                 [-4.6484e-01,  1.5137e-01, -4.9609e-01, | |
[stderr] | |                       ...,  2.8906e-01,                                 | |
[stderr] | |                                   3.3789e-01, -6.8750e-01],             | |
[stderr] | |                                 [ 2.5195e-01,  2.8906e-01, -2.9297e-01, | |
[stderr] | |                       ...,  1.2329e-02,                                 | |
[stderr] | |                                   1.4297e+00, -3.7695e-01]],            | |
[stderr] | |                                                                         | |
[stderr] | |                                [[ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 [ 0.0000e+00,  0.0000e+00,  0.0000e+00, | |
[stderr] | |                       ...,  0.0000e+00,                                 | |
[stderr] | |                                   0.0000e+00,  0.0000e+00],             | |
[stderr] | |                                 ...,                                    | |
[stderr] | |                                 [ 1.1094e+00, -1.9409e-02, -5.1953e-01, | |
[stderr] | |                       ...,  1.6211e-01,                                 | |
[stderr] | |                                   1.2109e+00,  3.8281e-01],             | |
[stderr] | |                                 [-1.2500e+00, -4.7852e-01,  1.3477e-01, | |
[stderr] | |                       ...,  1.3379e-01,                                 | |
[stderr] | |                                  -7.1094e-01,  2.1582e-01],             | |
[stderr] | |                                 [-1.3906e+00, -5.0000e-01, -3.7109e-01, | |
[stderr] | |                       ..., -1.3770e-01,                                 | |
[stderr] | |                                  -5.7373e-02,  7.5195e-02]]]],          | |
[stderr] | |                       dtype=torch.bfloat16,                             | |
[stderr] | |                              grad_fn=<CatBackward0>)                    | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] |                                                                             |
[stderr] | C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\tra |
[stderr] | nsformers\models\gpt_oss\modeling_gpt_oss.py:263 in eager_attention_forward |
[stderr] |                                                                             |
[stderr] |   260     probs = F.softmax(combined_logits, dim=-1, dtype=combined_logits. |
[stderr] |   261     scores = probs[..., :-1]  # we drop the sink here                 |
[stderr] |   262     attn_weights = nn.functional.dropout(scores, p=dropout, training= |
[stderr] | > 263     attn_output = torch.matmul(attn_weights, value_states)            |
[stderr] |   264     attn_output = attn_output.transpose(1, 2).contiguous()            |
[stderr] |   265     return attn_output, attn_weights                                  |
[stderr] |   266                                                                       |
[stderr] |                                                                             |
[stderr] | +-------------------------------- locals ---------------------------------+ |
[stderr] | |  attention_mask = tensor([[[[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,    | |
[stderr] | |                   0., 0., 0., 0., 0., 0., 0.]]]])                       | |
[stderr] | |    attn_weights = tensor([[[[0.0106, 0.0106, 0.0106,  ..., 0.0204,      | |
[stderr] | |                   0.0092, 0.0076]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0233, 0.0233, 0.0233,  ..., 0.0004,      | |
[stderr] | |                   0.1978, 0.0837]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0385, 0.0385, 0.0385,  ..., 0.0442,      | |
[stderr] | |                   0.0537, 0.0395]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0062, 0.0062, 0.0062,  ..., 0.0020,      | |
[stderr] | |                   0.0366, 0.0029]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0097, 0.0097, 0.0097,  ..., 0.1614,      | |
[stderr] | |                   0.0811, 0.0949]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0103, 0.0103, 0.0103,  ..., 0.0022,      | |
[stderr] | |                   0.0417, 0.0395]]]],                                   | |
[stderr] | |                          grad_fn=<SliceBackward0>)                      | |
[stderr] | |     causal_mask = tensor([[[[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,    | |
[stderr] | |                   0., 0., 0., 0., 0., 0., 0.]]]])                       | |
[stderr] | | combined_logits = tensor([[[[-3.9844, -3.9844, -3.9844,  ..., -4.1299,  | |
[stderr] | |                   -4.3164,  0.0000]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-3.2656, -3.2656, -3.2656,  ..., -1.1250,  | |
[stderr] | |                   -1.9844,  0.0000]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-2.3594, -2.3594, -2.3594,  ..., -2.0254,  | |
[stderr] | |                   -2.3335,  0.0000]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-5.0000, -5.0000, -5.0000,  ..., -3.2266,  | |
[stderr] | |                   -5.7578,  0.0000]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-2.8906, -2.8906, -2.8906,  ..., -0.7656,  | |
[stderr] | |                   -0.6094, -0.8594]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-4.2188, -4.2188, -4.2188,  ..., -2.8203,  | |
[stderr] | |                   -2.8750, -2.4531]]]],                                 | |
[stderr] | |                          grad_fn=<SubBackward0>)                        | |
[stderr] | |         dropout = 0.0                                                   | |
[stderr] | |             key = tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-2.1250e+00,  1.0391e+00, -2.9062e+00,     | |
[stderr] | |                   ..., -7.4158e-03,                                     | |
[stderr] | |                              -1.6797e+00, -1.0469e+00],                 | |
[stderr] | |                             [-8.2812e-01,  4.8828e-02, -5.9766e-01,     | |
[stderr] | |                   ..., -1.2812e+00,                                     | |
[stderr] | |                               1.0859e+00,  2.2344e+00],                 | |
[stderr] | |                             [-4.1406e-01, -4.1992e-01, -1.4453e+00,     | |
[stderr] | |                   ..., -5.0000e+00,                                     | |
[stderr] | |                               8.7109e-01, -1.6094e+00]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 1.2500e+01,  2.7188e+00,  4.7070e-01,     | |
[stderr] | |                   ..., -3.4375e+00,                                     | |
[stderr] | |                              -7.0312e-01, -1.9297e+00],                 | |
[stderr] | |                             [-3.9648e-01, -2.2812e+00, -2.9102e-01,     | |
[stderr] | |                   ..., -1.6875e+00,                                     | |
[stderr] | |                              -1.0078e+00,  6.2891e-01],                 | |
[stderr] | |                             [-1.1688e+01, -4.0312e+00, -9.6875e-01,     | |
[stderr] | |                   ..., -3.2812e+00,                                     | |
[stderr] | |                              -1.9844e+00,  5.4688e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-2.6367e-01,  2.1680e-01, -1.1328e+00,     | |
[stderr] | |                   ..., -8.3594e-01,                                     | |
[stderr] | |                              -2.5469e+00,  8.5156e-01],                 | |
[stderr] | |                             [-1.0132e-02,  6.3965e-02, -1.8799e-02,     | |
[stderr] | |                   ...,  2.5938e+00,                                     | |
[stderr] | |                               2.1875e+00, -1.6357e-02],                 | |
[stderr] | |                             [-3.0859e-01, -4.2969e-01, -1.4844e-01,     | |
[stderr] | |                   ..., -6.2109e-01,                                     | |
[stderr] | |                              -1.1719e+00, -2.3906e+00]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-1.3672e+00, -1.7969e+00, -2.2344e+00,     | |
[stderr] | |                   ..., -8.1250e-01,                                     | |
[stderr] | |                              -1.7734e+00, -5.6641e-01],                 | |
[stderr] | |                             [-2.0996e-01,  1.1816e-01, -4.7852e-02,     | |
[stderr] | |                   ...,  6.2109e-01,                                     | |
[stderr] | |                              -1.5625e+00, -2.7344e+00],                 | |
[stderr] | |                             [-1.8164e-01,  2.6953e-01, -5.8203e-01,     | |
[stderr] | |                   ..., -1.0859e+00,                                     | |
[stderr] | |                              -1.8125e+00, -2.6562e+00]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 3.9062e-03, -1.2812e+00, -6.9141e-01,     | |
[stderr] | |                   ...,  3.9844e+00,                                     | |
[stderr] | |                              -4.7812e+00,  2.6875e+00],                 | |
[stderr] | |                             [ 5.6641e-01, -9.4238e-02, -1.4258e-01,     | |
[stderr] | |                   ..., -1.0000e+00,                                     | |
[stderr] | |                               5.0000e-01,  1.4609e+00],                 | |
[stderr] | |                             [ 6.8359e-01,  1.3086e-01,  3.2422e-01,     | |
[stderr] | |                   ..., -2.6953e-01,                                     | |
[stderr] | |                               9.2285e-02, -5.0625e+00]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-1.7734e+00,  2.3438e-01,  2.5000e+00,     | |
[stderr] | |                   ..., -1.2891e+00,                                     | |
[stderr] | |                              -1.6504e-01,  1.2109e+00],                 | |
[stderr] | |                             [ 1.2344e+00, -3.6133e-01,  7.0312e-01,     | |
[stderr] | |                   ...,  6.4844e-01,                                     | |
[stderr] | |                              -1.1523e-01, -1.6094e+00],                 | |
[stderr] | |                             [ 1.5000e+00, -1.1250e+00,  8.0078e-02,     | |
[stderr] | |                   ..., -2.1250e+00,                                     | |
[stderr] | |                               2.3125e+00, -8.8379e-02]]]],              | |
[stderr] | |                   dtype=torch.bfloat16,                                 | |
[stderr] | |                          grad_fn=<CatBackward0>)                        | |
[stderr] | |      key_states = tensor([[[[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-2.1250,  1.0391, -2.9062,  ..., -0.0074,  | |
[stderr] | |                   -1.6797, -1.0469],                                    | |
[stderr] | |                             [-0.8281,  0.0488, -0.5977,  ..., -1.2812,  | |
[stderr] | |                   1.0859,  2.2344],                                     | |
[stderr] | |                             [-0.4141, -0.4199, -1.4453,  ..., -5.0000,  | |
[stderr] | |                   0.8711, -1.6094]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-2.1250,  1.0391, -2.9062,  ..., -0.0074,  | |
[stderr] | |                   -1.6797, -1.0469],                                    | |
[stderr] | |                             [-0.8281,  0.0488, -0.5977,  ..., -1.2812,  | |
[stderr] | |                   1.0859,  2.2344],                                     | |
[stderr] | |                             [-0.4141, -0.4199, -1.4453,  ..., -5.0000,  | |
[stderr] | |                   0.8711, -1.6094]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-2.1250,  1.0391, -2.9062,  ..., -0.0074,  | |
[stderr] | |                   -1.6797, -1.0469],                                    | |
[stderr] | |                             [-0.8281,  0.0488, -0.5977,  ..., -1.2812,  | |
[stderr] | |                   1.0859,  2.2344],                                     | |
[stderr] | |                             [-0.4141, -0.4199, -1.4453,  ..., -5.0000,  | |
[stderr] | |                   0.8711, -1.6094]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-1.7734,  0.2344,  2.5000,  ..., -1.2891,  | |
[stderr] | |                   -0.1650,  1.2109],                                    | |
[stderr] | |                             [ 1.2344, -0.3613,  0.7031,  ...,  0.6484,  | |
[stderr] | |                   -0.1152, -1.6094],                                    | |
[stderr] | |                             [ 1.5000, -1.1250,  0.0801,  ..., -2.1250,  | |
[stderr] | |                   2.3125, -0.0884]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-1.7734,  0.2344,  2.5000,  ..., -1.2891,  | |
[stderr] | |                   -0.1650,  1.2109],                                    | |
[stderr] | |                             [ 1.2344, -0.3613,  0.7031,  ...,  0.6484,  | |
[stderr] | |                   -0.1152, -1.6094],                                    | |
[stderr] | |                             [ 1.5000, -1.1250,  0.0801,  ..., -2.1250,  | |
[stderr] | |                   2.3125, -0.0884]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [-1.7734,  0.2344,  2.5000,  ..., -1.2891,  | |
[stderr] | |                   -0.1650,  1.2109],                                    | |
[stderr] | |                             [ 1.2344, -0.3613,  0.7031,  ...,  0.6484,  | |
[stderr] | |                   -0.1152, -1.6094],                                    | |
[stderr] | |                             [ 1.5000, -1.1250,  0.0801,  ..., -2.1250,  | |
[stderr] | |                   2.3125, -0.0884]]]],                                  | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                   grad_fn=<UnsafeViewBackward0>)                        | |
[stderr] | |          kwargs = {                                                     | |
[stderr] | |                       'sliding_window': None,                           | |
[stderr] | |                       's_aux': Parameter containing:                    | |
[stderr] | |                   tensor([ 3.9844,  3.2656,  2.3594,  2.2812,  3.0469,  | |
[stderr] | |                   4.3438,  2.1250,  2.6094,                             | |
[stderr] | |                            0.9922,  2.0625,  3.3594,  1.8438,  3.4375,  | |
[stderr] | |                   2.1250,  3.0000,  0.5156,                             | |
[stderr] | |                            2.5156, -0.3379, -0.4805,  2.6250,  7.8750,  | |
[stderr] | |                   7.5625,  3.7344,  4.6250,                             | |
[stderr] | |                            2.6406,  2.7969,  1.5781,  0.9727,  1.2344,  | |
[stderr] | |                   1.7812,  1.5703,  1.6328,                             | |
[stderr] | |                            4.6562,  4.4375,  3.6250,  4.0625,  3.0625,  | |
[stderr] | |                   3.7188,  4.4062,  5.6875,                             | |
[stderr] | |                            5.0938,  3.9375,  4.3438,  4.1562,  4.4688,  | |
[stderr] | |                   3.8906,  3.2812,  2.3594,                             | |
[stderr] | |                            6.7500,  1.8750,  6.5000,  5.8125,  5.0312,  | |
[stderr] | |                   6.8750,  6.9062,  6.7812,                             | |
[stderr] | |                            1.3203,  2.2031,  5.5312,  2.2500,  1.3750,  | |
[stderr] | |                   5.0000,  2.0312,  1.7656],                            | |
[stderr] | |                          dtype=torch.bfloat16, requires_grad=True),     | |
[stderr] | |                       'position_ids': tensor([[12]]),                   | |
[stderr] | |                       'use_cache': True,                                | |
[stderr] | |                       'output_router_logits': False                     | |
[stderr] | |                   }                                                     | |
[stderr] | |          module = GptOssAttention(                                      | |
[stderr] | |                     (q_proj): Linear(in_features=2880,                  | |
[stderr] | |                   out_features=4096, bias=True)                         | |
[stderr] | |                     (k_proj): Linear(in_features=2880,                  | |
[stderr] | |                   out_features=512, bias=True)                          | |
[stderr] | |                     (v_proj): Linear(in_features=2880,                  | |
[stderr] | |                   out_features=512, bias=True)                          | |
[stderr] | |                     (o_proj): Linear(in_features=4096,                  | |
[stderr] | |                   out_features=2880, bias=True)                         | |
[stderr] | |                   )                                                     | |
[stderr] | |           probs = tensor([[[[0.0106, 0.0106, 0.0106,  ..., 0.0092,      | |
[stderr] | |                   0.0076, 0.5700]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0233, 0.0233, 0.0233,  ..., 0.1978,      | |
[stderr] | |                   0.0837, 0.6092]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0385, 0.0385, 0.0385,  ..., 0.0537,      | |
[stderr] | |                   0.0395, 0.4072]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0062, 0.0062, 0.0062,  ..., 0.0366,      | |
[stderr] | |                   0.0029, 0.9209]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0097, 0.0097, 0.0097,  ..., 0.0811,      | |
[stderr] | |                   0.0949, 0.0739]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0103, 0.0103, 0.0103,  ..., 0.0417,      | |
[stderr] | |                   0.0395, 0.0602]]]],                                   | |
[stderr] | |                          grad_fn=<SoftmaxBackward0>)                    | |
[stderr] | |           query = tensor([[[[ 5.6152e-02,  3.8477e-01, -1.9531e-01,     | |
[stderr] | |                   ...,  6.1719e-01,                                     | |
[stderr] | |                               1.6797e+00, -6.5625e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.6641e-02,  3.3594e-01, -1.4648e-03,     | |
[stderr] | |                   ...,  5.8594e-01,                                     | |
[stderr] | |                               1.3750e+00,  4.1016e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-3.3447e-02,  4.4922e-02, -1.5991e-02,     | |
[stderr] | |                   ..., -1.6172e+00,                                     | |
[stderr] | |                               7.0312e-01,  7.3047e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-1.0205e-01, -4.1992e-02, -1.1621e-01,     | |
[stderr] | |                   ...,  3.9688e+00,                                     | |
[stderr] | |                               7.1875e-01, -5.0781e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.4688e-02, -1.0840e-01,  4.7266e-01,     | |
[stderr] | |                   ...,  4.8242e-01,                                     | |
[stderr] | |                              -1.7285e-01,  1.3516e+00]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-7.7148e-02, -5.6250e-01, -9.5312e-01,     | |
[stderr] | |                   ...,  2.8906e+00,                                     | |
[stderr] | |                              -4.5898e-01,  7.5000e-01]]]],              | |
[stderr] | |                   dtype=torch.bfloat16,                                 | |
[stderr] | |                          grad_fn=<CatBackward0>)                        | |
[stderr] | |         scaling = 0.125                                                 | |
[stderr] | |          scores = tensor([[[[0.0106, 0.0106, 0.0106,  ..., 0.0204,      | |
[stderr] | |                   0.0092, 0.0076]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0233, 0.0233, 0.0233,  ..., 0.0004,      | |
[stderr] | |                   0.1978, 0.0837]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0385, 0.0385, 0.0385,  ..., 0.0442,      | |
[stderr] | |                   0.0537, 0.0395]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0062, 0.0062, 0.0062,  ..., 0.0020,      | |
[stderr] | |                   0.0366, 0.0029]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0097, 0.0097, 0.0097,  ..., 0.1614,      | |
[stderr] | |                   0.0811, 0.0949]],                                     | |
[stderr] | |                                                                         | |
[stderr] | |                            [[0.0103, 0.0103, 0.0103,  ..., 0.0022,      | |
[stderr] | |                   0.0417, 0.0395]]]],                                   | |
[stderr] | |                          grad_fn=<SliceBackward0>)                      | |
[stderr] | |           sinks = tensor([[[[ 3.9844]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.2656]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.3594]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.2812]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.0469]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.3438]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.1250]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.6094]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.9922]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.0625]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.3594]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.8438]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.4375]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.1250]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.0000]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.5156]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.5156]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-0.3379]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[-0.4805]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.6250]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 7.8750]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 7.5625]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.7344]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.6250]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.6406]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.7969]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.5781]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.9727]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.2344]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.7812]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.5703]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.6328]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.6562]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.4375]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.6250]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.0625]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.0625]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.7188]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.4062]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.6875]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.0938]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.9375]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.3438]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.1562]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 4.4688]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.8906]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 3.2812]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.3594]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 6.7500]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.8750]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 6.5000]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.8125]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.0312]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 6.8750]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 6.9062]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 6.7812]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.3203]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.2031]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.5312]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.2500]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.3750]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 5.0000]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 2.0312]],                                 | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 1.7656]]]], dtype=torch.bfloat16,         | |
[stderr] | |                   grad_fn=<ExpandBackward0>)                            | |
[stderr] | |           value = tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 9.2578e-01, -5.0391e-01, -1.3203e+00,     | |
[stderr] | |                   ...,  2.1562e+00,                                     | |
[stderr] | |                              -1.1953e+00, -1.7656e+00],                 | |
[stderr] | |                             [-1.4844e+00, -7.2656e-01,  7.1484e-01,     | |
[stderr] | |                   ...,  7.1289e-02,                                     | |
[stderr] | |                              -6.4062e-01, -1.1169e-02],                 | |
[stderr] | |                             [-5.5859e-01,  2.4219e+00,  1.5938e+00,     | |
[stderr] | |                   ...,  1.6641e+00,                                     | |
[stderr] | |                               1.1328e+00, -5.0000e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 3.3447e-02,  1.7500e+00, -5.7031e-01,     | |
[stderr] | |                   ..., -3.1250e-01,                                     | |
[stderr] | |                              -3.3008e-01,  6.6797e-01],                 | |
[stderr] | |                             [-1.0938e+00,  4.9023e-01, -6.2500e-01,     | |
[stderr] | |                   ..., -1.2256e-01,                                     | |
[stderr] | |                              -9.7656e-01,  2.0312e-01],                 | |
[stderr] | |                             [-2.6875e+00,  1.2500e+00, -3.1128e-02,     | |
[stderr] | |                   ..., -3.2031e-01,                                     | |
[stderr] | |                              -1.3281e+00,  2.5781e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 7.2754e-02, -3.5938e-01,  9.8438e-01,     | |
[stderr] | |                   ..., -2.0312e+00,                                     | |
[stderr] | |                              -1.2578e+00, -8.6719e-01],                 | |
[stderr] | |                             [ 1.2891e+00, -2.5781e-01, -1.7480e-01,     | |
[stderr] | |                   ..., -6.1719e-01,                                     | |
[stderr] | |                               4.1797e-01, -3.2617e-01],                 | |
[stderr] | |                             [ 7.3047e-01, -3.9062e-01,  2.8320e-01,     | |
[stderr] | |                   ..., -1.1406e+00,                                     | |
[stderr] | |                               3.5547e-01, -8.7402e-02]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 5.6250e-01,  1.6406e-01,  2.6855e-03,     | |
[stderr] | |                   ...,  4.6484e-01,                                     | |
[stderr] | |                               8.2031e-01, -1.0938e+00],                 | |
[stderr] | |                             [ 1.0156e-01, -2.2852e-01,  8.9844e-01,     | |
[stderr] | |                   ..., -2.8711e-01,                                     | |
[stderr] | |                               1.3770e-01, -8.1250e-01],                 | |
[stderr] | |                             [-4.1602e-01,  3.9258e-01,  3.1445e-01,     | |
[stderr] | |                   ...,  5.6641e-01,                                     | |
[stderr] | |                               4.3359e-01, -7.8906e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 2.7969e+00,  1.0693e-01, -1.3672e+00,     | |
[stderr] | |                   ..., -2.8125e+00,                                     | |
[stderr] | |                               1.5747e-02,  1.7422e+00],                 | |
[stderr] | |                             [-4.6484e-01,  1.5137e-01, -4.9609e-01,     | |
[stderr] | |                   ...,  2.8906e-01,                                     | |
[stderr] | |                               3.3789e-01, -6.8750e-01],                 | |
[stderr] | |                             [ 2.5195e-01,  2.8906e-01, -2.9297e-01,     | |
[stderr] | |                   ...,  1.2329e-02,                                     | |
[stderr] | |                               1.4297e+00, -3.7695e-01]],                | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             [ 0.0000e+00,  0.0000e+00,  0.0000e+00,     | |
[stderr] | |                   ...,  0.0000e+00,                                     | |
[stderr] | |                               0.0000e+00,  0.0000e+00],                 | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 1.1094e+00, -1.9409e-02, -5.1953e-01,     | |
[stderr] | |                   ...,  1.6211e-01,                                     | |
[stderr] | |                               1.2109e+00,  3.8281e-01],                 | |
[stderr] | |                             [-1.2500e+00, -4.7852e-01,  1.3477e-01,     | |
[stderr] | |                   ...,  1.3379e-01,                                     | |
[stderr] | |                              -7.1094e-01,  2.1582e-01],                 | |
[stderr] | |                             [-1.3906e+00, -5.0000e-01, -3.7109e-01,     | |
[stderr] | |                   ..., -1.3770e-01,                                     | |
[stderr] | |                              -5.7373e-02,  7.5195e-02]]]],              | |
[stderr] | |                   dtype=torch.bfloat16,                                 | |
[stderr] | |                          grad_fn=<CatBackward0>)                        | |
[stderr] | |    value_states = tensor([[[[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 0.9258, -0.5039, -1.3203,  ...,  2.1562,  | |
[stderr] | |                   -1.1953, -1.7656],                                    | |
[stderr] | |                             [-1.4844, -0.7266,  0.7148,  ...,  0.0713,  | |
[stderr] | |                   -0.6406, -0.0112],                                    | |
[stderr] | |                             [-0.5586,  2.4219,  1.5938,  ...,  1.6641,  | |
[stderr] | |                   1.1328, -0.5000]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 0.9258, -0.5039, -1.3203,  ...,  2.1562,  | |
[stderr] | |                   -1.1953, -1.7656],                                    | |
[stderr] | |                             [-1.4844, -0.7266,  0.7148,  ...,  0.0713,  | |
[stderr] | |                   -0.6406, -0.0112],                                    | |
[stderr] | |                             [-0.5586,  2.4219,  1.5938,  ...,  1.6641,  | |
[stderr] | |                   1.1328, -0.5000]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 0.9258, -0.5039, -1.3203,  ...,  2.1562,  | |
[stderr] | |                   -1.1953, -1.7656],                                    | |
[stderr] | |                             [-1.4844, -0.7266,  0.7148,  ...,  0.0713,  | |
[stderr] | |                   -0.6406, -0.0112],                                    | |
[stderr] | |                             [-0.5586,  2.4219,  1.5938,  ...,  1.6641,  | |
[stderr] | |                   1.1328, -0.5000]],                                    | |
[stderr] | |                                                                         | |
[stderr] | |                            ...,                                         | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 1.1094, -0.0194, -0.5195,  ...,  0.1621,  | |
[stderr] | |                   1.2109,  0.3828],                                     | |
[stderr] | |                             [-1.2500, -0.4785,  0.1348,  ...,  0.1338,  | |
[stderr] | |                   -0.7109,  0.2158],                                    | |
[stderr] | |                             [-1.3906, -0.5000, -0.3711,  ..., -0.1377,  | |
[stderr] | |                   -0.0574,  0.0752]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 1.1094, -0.0194, -0.5195,  ...,  0.1621,  | |
[stderr] | |                   1.2109,  0.3828],                                     | |
[stderr] | |                             [-1.2500, -0.4785,  0.1348,  ...,  0.1338,  | |
[stderr] | |                   -0.7109,  0.2158],                                    | |
[stderr] | |                             [-1.3906, -0.5000, -0.3711,  ..., -0.1377,  | |
[stderr] | |                   -0.0574,  0.0752]],                                   | |
[stderr] | |                                                                         | |
[stderr] | |                            [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  | |
[stderr] | |                   0.0000,  0.0000],                                     | |
[stderr] | |                             ...,                                        | |
[stderr] | |                             [ 1.1094, -0.0194, -0.5195,  ...,  0.1621,  | |
[stderr] | |                   1.2109,  0.3828],                                     | |
[stderr] | |                             [-1.2500, -0.4785,  0.1348,  ...,  0.1338,  | |
[stderr] | |                   -0.7109,  0.2158],                                    | |
[stderr] | |                             [-1.3906, -0.5000, -0.3711,  ..., -0.1377,  | |
[stderr] | |                   -0.0574,  0.0752]]]],                                 | |
[stderr] | |                          dtype=torch.bfloat16,                          | |
[stderr] | |                   grad_fn=<UnsafeViewBackward0>)                        | |
[stderr] | +-------------------------------------------------------------------------+ |
[stderr] +-----------------------------------------------------------------------------+
[stderr] RuntimeError: expected m1 and m2 to have the same dtype, but got: float != 
[stderr] struct c10::BFloat16
